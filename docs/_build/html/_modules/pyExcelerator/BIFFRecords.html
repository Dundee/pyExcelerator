
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyExcelerator.BIFFRecords &mdash; pyExcelerator 0.6.4.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.6.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyExcelerator 0.6.4.1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="../../_static/small_flask.css" type= "text/css" rel="stylesheet" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">pyExcelerator 0.6.4.1 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pyExcelerator.BIFFRecords</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: windows-1251 -*-</span>

<span class="c">#  Copyright (C) 2005 Roman V. Kiseliov</span>
<span class="c">#  All rights reserved.</span>
<span class="c">#</span>
<span class="c">#  Redistribution and use in source and binary forms, with or without</span>
<span class="c">#  modification, are permitted provided that the following conditions</span>
<span class="c">#  are met:</span>
<span class="c">#</span>
<span class="c">#  1. Redistributions of source code must retain the above copyright</span>
<span class="c">#     notice, this list of conditions and the following disclaimer.</span>
<span class="c">#</span>
<span class="c">#  2. Redistributions in binary form must reproduce the above copyright</span>
<span class="c">#     notice, this list of conditions and the following disclaimer in</span>
<span class="c">#     the documentation and/or other materials provided with the</span>
<span class="c">#     distribution.</span>
<span class="c">#</span>
<span class="c">#  3. All advertising materials mentioning features or use of this</span>
<span class="c">#     software must display the following acknowledgment:</span>
<span class="c">#     &quot;This product includes software developed by</span>
<span class="c">#      Roman V. Kiseliov &lt;roman@kiseliov.ru&gt;.&quot;</span>
<span class="c">#</span>
<span class="c">#  4. Redistributions of any form whatsoever must retain the following</span>
<span class="c">#     acknowledgment:</span>
<span class="c">#     &quot;This product includes software developed by</span>
<span class="c">#      Roman V. Kiseliov &lt;roman@kiseliov.ru&gt;.&quot;</span>
<span class="c">#</span>
<span class="c">#  THIS SOFTWARE IS PROVIDED BY Roman V. Kiseliov ``AS IS&#39;&#39; AND ANY</span>
<span class="c">#  EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c">#  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</span>
<span class="c">#  PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL Roman V. Kiseliov OR</span>
<span class="c">#  ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c">#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span>
<span class="c">#  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<span class="c">#  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<span class="c">#  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span>
<span class="c">#  STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="c">#  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED</span>
<span class="c">#  OF THE POSSIBILITY OF SUCH DAMAGE.</span>

<span class="n">__rev_id__</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;$Id: BIFFRecords.py,v 1.7 2005/10/26 07:44:24 rvk Exp $&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">pack</span>
<span class="kn">from</span> <span class="nn">UnicodeUtils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>

<div class="viewcode-block" id="SharedStringTable"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SharedStringTable">[docs]</a><span class="k">class</span> <span class="nc">SharedStringTable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">_SST_ID</span> <span class="o">=</span> <span class="mh">0x00FC</span>
    <span class="n">_CONTINUE_ID</span> <span class="o">=</span> <span class="mh">0x003C</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sst_record</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_continues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;II&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_str_indexes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_calls</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="SharedStringTable.add_str"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SharedStringTable.add_str">[docs]</a>    <span class="k">def</span> <span class="nf">add_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_calls</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_indexes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_str_indexes</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str_indexes</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_sst</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_indexes</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="SharedStringTable.str_index"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SharedStringTable.str_index">[docs]</a>    <span class="k">def</span> <span class="nf">str_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str_indexes</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="SharedStringTable.get_biff_record"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SharedStringTable.get_biff_record">[docs]</a>    <span class="k">def</span> <span class="nf">get_biff_record</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_piece</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2HII&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SST_ID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sst_record</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_calls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_str_indexes</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sst_record</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_continues</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</div>
    <span class="k">def</span> <span class="nf">_add_to_sst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">u_str</span> <span class="o">=</span> <span class="n">upack2</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">u_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0xFFFF</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;error: very long string.&#39;</span><span class="p">)</span>

        <span class="n">is_unicode_str</span> <span class="o">=</span> <span class="n">u_str</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;</span><span class="se">\x01</span><span class="s">&#39;</span>
        <span class="k">if</span> <span class="n">is_unicode_str</span><span class="p">:</span>
            <span class="n">atom_len</span> <span class="o">=</span> <span class="mi">5</span> <span class="c"># 2 byte -- len,</span>
                         <span class="c"># 1 byte -- options,</span>
                         <span class="c"># 2 byte -- 1st sym</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atom_len</span> <span class="o">=</span> <span class="mi">4</span> <span class="c"># 2 byte -- len,</span>
                         <span class="c"># 1 byte -- options,</span>
                         <span class="c"># 1 byte -- 1st sym</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_save_atom</span><span class="p">(</span><span class="n">u_str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">atom_len</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_splitted</span><span class="p">(</span><span class="n">u_str</span><span class="p">[</span><span class="n">atom_len</span><span class="p">:],</span> <span class="n">is_unicode_str</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_new_piece</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sst_record</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sst_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">curr_piece_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_continues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2H</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="n">curr_piece_len</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CONTINUE_ID</span><span class="p">,</span> <span class="n">curr_piece_len</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_save_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">atom_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">free_space</span> <span class="o">=</span> <span class="mh">0x2020</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">free_space</span> <span class="o">&lt;</span> <span class="n">atom_len</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_new_piece</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span> <span class="o">+=</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">_save_splitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">is_unicode_str</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">str_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">str_len</span><span class="p">:</span>
            <span class="n">piece_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span><span class="p">)</span>
            <span class="n">free_space</span> <span class="o">=</span> <span class="mh">0x2020</span> <span class="o">-</span> <span class="n">piece_len</span>
            <span class="n">tail_len</span> <span class="o">=</span> <span class="n">str_len</span> <span class="o">-</span> <span class="n">i</span>
            <span class="n">need_more_space</span> <span class="o">=</span> <span class="n">free_space</span> <span class="o">&lt;</span> <span class="n">tail_len</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">need_more_space</span><span class="p">:</span>
                <span class="n">atom_len</span> <span class="o">=</span> <span class="n">tail_len</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_unicode_str</span><span class="p">:</span>
                    <span class="n">atom_len</span> <span class="o">=</span> <span class="n">free_space</span> <span class="o">&amp;</span> <span class="mh">0xFFFE</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">atom_len</span> <span class="o">=</span> <span class="n">free_space</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">atom_len</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">need_more_space</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_new_piece</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">is_unicode_str</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\x01</span><span class="s">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_current_piece</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\x00</span><span class="s">&#39;</span>

            <span class="n">i</span> <span class="o">+=</span> <span class="n">atom_len</span>

</div>
<div class="viewcode-block" id="BiffRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BiffRecord">[docs]</a><span class="k">class</span> <span class="nc">BiffRecord</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

<div class="viewcode-block" id="BiffRecord.get_rec_id"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BiffRecord.get_rec_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_rec_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_REC_ID</span>
</div>
<div class="viewcode-block" id="BiffRecord.get_rec_header"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BiffRecord.get_rec_header">[docs]</a>    <span class="k">def</span> <span class="nf">get_rec_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_REC_ID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="BiffRecord.get_rec_data"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BiffRecord.get_rec_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_rec_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span>
</div>
<div class="viewcode-block" id="BiffRecord.get"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BiffRecord.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rec_data</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x2020</span><span class="p">:</span> <span class="c"># limit for BIFF7/8</span>
            <span class="n">chunks</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">chunk_pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mh">0x2020</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span><span class="n">chunk_pos</span><span class="p">]</span>
                <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">chunk_pos</span>
            <span class="n">continues</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_REC_ID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">continues</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2H</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">),</span> <span class="mh">0x003C</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">),</span> <span class="n">chunk</span><span class="p">)</span>
                <span class="c"># 0x003C -- CONTINUE record id</span>
            <span class="k">return</span> <span class="n">continues</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rec_header</span><span class="p">()</span> <span class="o">+</span> <span class="n">data</span>

</div></div>
<div class="viewcode-block" id="Biff8BOFRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.Biff8BOFRecord">[docs]</a><span class="k">class</span> <span class="nc">Biff8BOFRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Offset Size Contents</span>
<span class="sd">    0      2    Version, contains 0600H for BIFF8 and BIFF8X</span>
<span class="sd">    2      2    Type of the following data:</span>
<span class="sd">                  0005H = Workbook globals</span>
<span class="sd">                  0006H = Visual Basic module</span>
<span class="sd">                  0010H = Worksheet</span>
<span class="sd">                  0020H = Chart</span>
<span class="sd">                  0040H = Macro sheet</span>
<span class="sd">                  0100H = Workspace file</span>
<span class="sd">    4      2    Build identifier</span>
<span class="sd">    6      2    Build year</span>
<span class="sd">    8      4    File history flags</span>
<span class="sd">    12     4    Lowest Excel version that can read all records in this file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span>      <span class="o">=</span> <span class="mh">0x0809</span>
    <span class="c"># stream types</span>
    <span class="n">BOOK_GLOBAL</span> <span class="o">=</span> <span class="mh">0x0005</span>
    <span class="n">VB_MODULE</span>   <span class="o">=</span> <span class="mh">0x0006</span>
    <span class="n">WORKSHEET</span>   <span class="o">=</span> <span class="mh">0x0010</span>
    <span class="n">CHART</span>       <span class="o">=</span> <span class="mh">0x0020</span>
    <span class="n">MACROSHEET</span>  <span class="o">=</span> <span class="mh">0x0040</span>
    <span class="n">WORKSPACE</span>   <span class="o">=</span> <span class="mh">0x0100</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rec_type</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">version</span>  <span class="o">=</span> <span class="mh">0x0600</span>
        <span class="n">build</span>    <span class="o">=</span> <span class="mh">0x0DBB</span>
        <span class="n">year</span>     <span class="o">=</span> <span class="mh">0x07CC</span>
        <span class="n">file_hist_flags</span> <span class="o">=</span> <span class="mh">0x00</span><span class="n">L</span>
        <span class="n">ver_can_read</span>    <span class="o">=</span> <span class="mh">0x06</span><span class="n">L</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4H2I&#39;</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">rec_type</span><span class="p">,</span> <span class="n">build</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">file_hist_flags</span><span class="p">,</span> <span class="n">ver_can_read</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="InteraceHdrRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.InteraceHdrRecord">[docs]</a><span class="k">class</span> <span class="nc">InteraceHdrRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00E1</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;BB&#39;</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="InteraceEndRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.InteraceEndRecord">[docs]</a><span class="k">class</span> <span class="nc">InteraceEndRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00E2</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

</div>
<div class="viewcode-block" id="MMSRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.MMSRecord">[docs]</a><span class="k">class</span> <span class="nc">MMSRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00C1</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WriteAccessRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.WriteAccessRecord">[docs]</a><span class="k">class</span> <span class="nc">WriteAccessRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the file protection. It contains the name of the</span>
<span class="sd">    user  that  has  saved  the  file. The user name is always stored as an</span>
<span class="sd">    equal-sized  string.  All  unused  characters after the name are filled</span>
<span class="sd">    with space characters. It is not required to write the mentioned string</span>
<span class="sd">    length. Every other length will be accepted too.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x005C</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">uowner</span> <span class="o">=</span> <span class="n">owner</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mh">0x30</span><span class="p">]</span>
        <span class="n">uowner_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uowner</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">s</span><span class="si">%d</span><span class="s">s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uowner_len</span><span class="p">,</span> <span class="mh">0x70</span> <span class="o">-</span> <span class="n">uowner_len</span><span class="p">),</span> <span class="n">uowner</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="mh">0x70</span> <span class="o">-</span> <span class="n">uowner_len</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="DSFRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.DSFRecord">[docs]</a><span class="k">class</span> <span class="nc">DSFRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  specifies  if the file contains an additional BIFF5/BIFF7</span>
<span class="sd">    workbook stream.</span>
<span class="sd">    Record DSF, BIFF8:</span>
<span class="sd">    Offset Size Contents</span>
<span class="sd">    0        2     0 = Only the BIFF8 Workbook stream is present</span>
<span class="sd">                   1 = Additional BIFF5/BIFF7 Book stream is in the file</span>
<span class="sd">    A  double  stream file can be read by Excel 5.0 and Excel 95, and still</span>
<span class="sd">    contains  all  new  features  added to BIFF8 (which are left out in the</span>
<span class="sd">    BIFF5/BIFF7 Book stream).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0161</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="TabIDRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.TabIDRecord">[docs]</a><span class="k">class</span> <span class="nc">TabIDRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x013D</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sheetcount</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sheetcount</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="FnGroupCountRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.FnGroupCountRecord">[docs]</a><span class="k">class</span> <span class="nc">FnGroupCountRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x009C</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;BB&#39;</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WindowProtectRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.WindowProtectRecord">[docs]</a><span class="k">class</span> <span class="nc">WindowProtectRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the worksheet/workbook protection. It determines</span>
<span class="sd">    whether  the window configuration of this document is protected. Window</span>
<span class="sd">    protection is not active, if this record is omitted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0019</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wndprotect</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">wndprotect</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ObjectProtectRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.ObjectProtectRecord">[docs]</a><span class="k">class</span> <span class="nc">ObjectProtectRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the worksheet/workbook protection.</span>
<span class="sd">    It determines whether the objects of the current sheet are protected.</span>
<span class="sd">    Object protection is not active, if this record is omitted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0063</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objprotect</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">objprotect</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ScenProtectRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.ScenProtectRecord">[docs]</a><span class="k">class</span> <span class="nc">ScenProtectRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the worksheet/workbook protection. It</span>
<span class="sd">    determines whether the scenarios of the current sheet are protected.</span>
<span class="sd">    Scenario protection is not active, if this record is omitted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00DD</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scenprotect</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">scenprotect</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ProtectRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.ProtectRecord">[docs]</a><span class="k">class</span> <span class="nc">ProtectRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record is part of the worksheet/workbook protection. It specifies</span>
<span class="sd">    whether  a  worksheet  or a workbook is protected against modification.</span>
<span class="sd">    Protection is not active, if this record is omitted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0012</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protect</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">protect</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="PasswordRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.PasswordRecord">[docs]</a><span class="k">class</span> <span class="nc">PasswordRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the worksheet/workbook protection. It</span>
<span class="sd">    stores a 16-bit hash value, calculated from the worksheet or workbook</span>
<span class="sd">    protection password.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0013</span>
<div class="viewcode-block" id="PasswordRecord.passwd_hash"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.PasswordRecord.passwd_hash">[docs]</a>    <span class="k">def</span> <span class="nf">passwd_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Based on the algorithm provided by Daniel Rentz of OpenOffice.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plaintext</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="n">passwd_hash</span> <span class="o">=</span> <span class="mh">0x0000</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plaintext</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">low_15</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&amp;</span> <span class="mh">0x7fff</span>
            <span class="n">high_15</span> <span class="o">=</span> <span class="n">c</span> <span class="o">&amp;</span> <span class="mh">0x7fff</span> <span class="o">&lt;&lt;</span> <span class="mi">15</span>
            <span class="n">high_15</span> <span class="o">=</span> <span class="n">high_15</span> <span class="o">&gt;&gt;</span> <span class="mi">15</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">low_15</span> <span class="o">|</span> <span class="n">high_15</span>
            <span class="n">passwd_hash</span> <span class="o">^=</span> <span class="n">c</span>
        <span class="n">passwd_hash</span> <span class="o">^=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
        <span class="n">passwd_hash</span> <span class="o">^=</span> <span class="mh">0xCE4B</span>
        <span class="k">return</span> <span class="n">passwd_hash</span>
</div>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">passwd</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">passwd_hash</span><span class="p">(</span><span class="n">passwd</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Prot4RevRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.Prot4RevRecord">[docs]</a><span class="k">class</span> <span class="nc">Prot4RevRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x01AF</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Prot4RevPassRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.Prot4RevPassRecord">[docs]</a><span class="k">class</span> <span class="nc">Prot4RevPassRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x01BC</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="BackupRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BackupRecord">[docs]</a><span class="k">class</span> <span class="nc">BackupRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  contains  a Boolean value determining whether Excel makes</span>
<span class="sd">    a backup of the file while saving.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0040</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backup</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">backup</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HideObjRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.HideObjRecord">[docs]</a><span class="k">class</span> <span class="nc">HideObjRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record specifies whether and how to show objects in the workbook.</span>

<span class="sd">    Record HIDEOBJ, BIFF3-BIFF8:</span>
<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Viewing mode for objects:</span>
<span class="sd">                        0 = Show all objects</span>
<span class="sd">                        1 = Show placeholders</span>
<span class="sd">                        2 = Do not show objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x008D</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="RefreshAllRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.RefreshAllRecord">[docs]</a><span class="k">class</span> <span class="nc">RefreshAllRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x01B7</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="BookBoolRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BookBoolRecord">[docs]</a><span class="k">class</span> <span class="nc">BookBoolRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record contains a Boolean value determining whether to save values</span>
<span class="sd">    linked  from external workbooks (CRN records and XCT records). In BIFF3</span>
<span class="sd">    and BIFF4 this option is stored in the WSBOOL record.</span>

<span class="sd">    Record BOOKBOOL, BIFF5-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Save external linked values;</span>
<span class="sd">                    1 = Do not save external linked values</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00DA</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="CountryRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.CountryRecord">[docs]</a><span class="k">class</span> <span class="nc">CountryRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This   record   stores  two  Windows  country  identifiers.  The  first</span>
<span class="sd">    represents  the  user  interface language of the Excel version that has</span>
<span class="sd">    saved  the file, and the second represents the system regional settings</span>
<span class="sd">    at the time the file was saved.</span>

<span class="sd">    Record COUNTRY, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Windows country identifier of the user interface language of Excel</span>
<span class="sd">    2       2       Windows country identifier of the system regional settings</span>

<span class="sd">    The  following  table  shows most of the used country identifiers. Most</span>
<span class="sd">    of  these  identifiers  are  equal to the international country calling</span>
<span class="sd">    codes.</span>

<span class="sd">    1   USA</span>
<span class="sd">    2   Canada</span>
<span class="sd">    7   Russia</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00DA</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ui_id</span><span class="p">,</span> <span class="n">sys_settings_id</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2H&#39;</span><span class="p">,</span> <span class="n">ui_id</span><span class="p">,</span> <span class="n">sys_settings_id</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="UseSelfsRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.UseSelfsRecord">[docs]</a><span class="k">class</span> <span class="nc">UseSelfsRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  specifies if the formulas in the workbook can use natural</span>
<span class="sd">    language  formulas”.  This  type  of  formula can refer to cells by its</span>
<span class="sd">    content or the content of the column or row header cell.</span>

<span class="sd">    Record USESELFS, BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Do not use natural language formulas</span>
<span class="sd">                    1 = Use natural language formulas</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0160</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="EOFRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.EOFRecord">[docs]</a><span class="k">class</span> <span class="nc">EOFRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x000A</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

</div>
<div class="viewcode-block" id="DateModeRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.DateModeRecord">[docs]</a><span class="k">class</span> <span class="nc">DateModeRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  specifies  the  base date for displaying date values. All</span>
<span class="sd">    dates  are  stored as count of days past this base date. In BIFF2-BIFF4</span>
<span class="sd">    this   record  is  part  of  the  Calculation  Settings  Block.</span>
<span class="sd">    In BIFF5-BIFF8 it is stored in the Workbook Globals Substream.</span>

<span class="sd">    Record DATEMODE, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Base is 1899-Dec-31 (the cell = 1 represents 1900-Jan-01)</span>
<span class="sd">                    1 = Base is 1904-Jan-01 (the cell = 1 represents 1904-Jan-02)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0022</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from1904</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">from1904</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="PrecisionRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.PrecisionRecord">[docs]</a><span class="k">class</span> <span class="nc">PrecisionRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record stores if formulas use the real cell values for calculation</span>
<span class="sd">    or  the  values  displayed  on  the screen. In BIFF2- BIFF4 this record</span>
<span class="sd">    is  part of the Calculation Settings Block. In BIFF5-BIFF8 it is stored</span>
<span class="sd">    in the Workbook Globals Substream.</span>

<span class="sd">    Record PRECISION, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Use displayed values;</span>
<span class="sd">                    1 = Use real cell values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x000E</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_real_values</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_real_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="CodepageBiff8Record"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.CodepageBiff8Record">[docs]</a><span class="k">class</span> <span class="nc">CodepageBiff8Record</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record stores the text encoding used to write byte strings, stored</span>
<span class="sd">    as MS Windows code page identifier. The CODEPAGE record in BIFF8 always</span>
<span class="sd">    contains  the  code  page  1200  (UTF-16).  Therefore  it is not</span>
<span class="sd">    possible  to  obtain the encoding used for a protection password (it is</span>
<span class="sd">    not UTF-16).</span>

<span class="sd">    Record CODEPAGE, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Code page identifier used for byte string text encoding:</span>
<span class="sd">                      016FH = 367 = ASCII</span>
<span class="sd">                      01B5H = 437 = IBM PC CP-437 (US)</span>
<span class="sd">                      02D0H = 720 = IBM PC CP-720 (OEM Arabic)</span>
<span class="sd">                      02E1H = 737 = IBM PC CP-737 (Greek)</span>
<span class="sd">                      0307H = 775 = IBM PC CP-775 (Baltic)</span>
<span class="sd">                      0352H = 850 = IBM PC CP-850 (Latin I)</span>
<span class="sd">                      0354H = 852 = IBM PC CP-852 (Latin II (Central European))</span>
<span class="sd">                      0357H = 855 = IBM PC CP-855 (Cyrillic)</span>
<span class="sd">                      0359H = 857 = IBM PC CP-857 (Turkish)</span>
<span class="sd">                      035AH = 858 = IBM PC CP-858 (Multilingual Latin I with Euro)</span>
<span class="sd">                      035CH = 860 = IBM PC CP-860 (Portuguese)</span>
<span class="sd">                      035DH = 861 = IBM PC CP-861 (Icelandic)</span>
<span class="sd">                      035EH = 862 = IBM PC CP-862 (Hebrew)</span>
<span class="sd">                      035FH = 863 = IBM PC CP-863 (Canadian (French))</span>
<span class="sd">                      0360H = 864 = IBM PC CP-864 (Arabic)</span>
<span class="sd">                      0361H = 865 = IBM PC CP-865 (Nordic)</span>
<span class="sd">                      0362H = 866 = IBM PC CP-866 (Cyrillic (Russian))</span>
<span class="sd">                      0365H = 869 = IBM PC CP-869 (Greek (Modern))</span>
<span class="sd">                      036AH = 874 = Windows CP-874 (Thai)</span>
<span class="sd">                      03A4H = 932 = Windows CP-932 (Japanese Shift-JIS)</span>
<span class="sd">                      03A8H = 936 = Windows CP-936 (Chinese Simplified GBK)</span>
<span class="sd">                      03B5H = 949 = Windows CP-949 (Korean (Wansung))</span>
<span class="sd">                      03B6H = 950 = Windows CP-950 (Chinese Traditional BIG5)</span>
<span class="sd">                      04B0H = 1200 = UTF-16 (BIFF8)</span>
<span class="sd">                      04E2H = 1250 = Windows CP-1250 (Latin II) (Central European)</span>
<span class="sd">                      04E3H = 1251 = Windows CP-1251 (Cyrillic)</span>
<span class="sd">                      04E4H = 1252 = Windows CP-1252 (Latin I) (BIFF4-BIFF7)</span>
<span class="sd">                      04E5H = 1253 = Windows CP-1253 (Greek)</span>
<span class="sd">                      04E6H = 1254 = Windows CP-1254 (Turkish)</span>
<span class="sd">                      04E7H = 1255 = Windows CP-1255 (Hebrew)</span>
<span class="sd">                      04E8H = 1256 = Windows CP-1256 (Arabic)</span>
<span class="sd">                      04E9H = 1257 = Windows CP-1257 (Baltic)</span>
<span class="sd">                      04EAH = 1258 = Windows CP-1258 (Vietnamese)</span>
<span class="sd">                      0551H = 1361 = Windows CP-1361 (Korean (Johab))</span>
<span class="sd">                      2710H = 10000 = Apple Roman</span>
<span class="sd">                      8000H = 32768 = Apple Roman</span>
<span class="sd">                      8001H = 32769 = Windows CP-1252 (Latin I) (BIFF2-BIFF3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0042</span>
    <span class="n">UTF_16</span> <span class="o">=</span> <span class="mh">0x04B0</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTF_16</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Window1Record"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.Window1Record">[docs]</a><span class="k">class</span> <span class="nc">Window1Record</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Offset Size Contents</span>
<span class="sd">    0      2    Horizontal position of the document window (in twips = 1/20 of a point)</span>
<span class="sd">    2      2    Vertical position of the document window (in twips = 1/20 of a point)</span>
<span class="sd">    4      2    Width of the document window (in twips = 1/20 of a point)</span>
<span class="sd">    6      2    Height of the document window (in twips = 1/20 of a point)</span>
<span class="sd">    8      2    Option flags:</span>
<span class="sd">                  Bits  Mask  Contents</span>
<span class="sd">                  0     0001H 0 = Window is visible 1 = Window is hidden</span>
<span class="sd">                  1     0002H 0 = Window is open 1 = Window is minimised</span>
<span class="sd">                  3     0008H 0 = Horizontal scroll bar hidden 1 = Horizontal scroll bar visible</span>
<span class="sd">                  4     0010H 0 = Vertical scroll bar hidden 1 = Vertical scroll bar visible</span>
<span class="sd">                  5     0020H 0 = Worksheet tab bar hidden 1 = Worksheet tab bar visible</span>
<span class="sd">    10     2    Index to active (displayed) worksheet</span>
<span class="sd">    12     2    Index of first visible tab in the worksheet tab bar</span>
<span class="sd">    14     2    Number of selected worksheets (highlighted in the worksheet tab bar)</span>
<span class="sd">    16     2    Width of worksheet tab bar (in 1/1000 of window width). The remaining space is used by the</span>
<span class="sd">                horizontal scrollbar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x003D</span>
    <span class="c"># flags</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">hpos_twips</span><span class="p">,</span> <span class="n">vpos_twips</span><span class="p">,</span>
                 <span class="n">width_twips</span><span class="p">,</span> <span class="n">height_twips</span><span class="p">,</span>
                 <span class="n">flags</span><span class="p">,</span>
                 <span class="n">active_sheet</span><span class="p">,</span>
                 <span class="n">first_tab_index</span><span class="p">,</span> <span class="n">selected_tabs</span><span class="p">,</span> <span class="n">tab_width</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;9H&#39;</span><span class="p">,</span> <span class="n">hpos_twips</span><span class="p">,</span> <span class="n">vpos_twips</span><span class="p">,</span>
                                      <span class="n">width_twips</span><span class="p">,</span> <span class="n">height_twips</span><span class="p">,</span>
                                      <span class="n">flags</span><span class="p">,</span>
                                      <span class="n">active_sheet</span><span class="p">,</span>
                                      <span class="n">first_tab_index</span><span class="p">,</span> <span class="n">selected_tabs</span><span class="p">,</span> <span class="n">tab_width</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FontRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.FontRecord">[docs]</a><span class="k">class</span> <span class="nc">FontRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    WARNING</span>
<span class="sd">        The font with index 4 is omitted in all BIFF versions.</span>
<span class="sd">        This means the first four fonts have zero-based indexes, and</span>
<span class="sd">        the fifth font and all following fonts are referenced with one-based</span>
<span class="sd">        indexes.</span>

<span class="sd">    Offset Size Contents</span>
<span class="sd">    0      2    Height of the font (in twips = 1/20 of a point)</span>
<span class="sd">    2      2    Option flags:</span>
<span class="sd">                  Bit Mask    Contents</span>
<span class="sd">                  0   0001H   1 = Characters are bold (redundant, see below)</span>
<span class="sd">                  1   0002H   1 = Characters are italic</span>
<span class="sd">                  2   0004H   1 = Characters are underlined (redundant, see below)</span>
<span class="sd">                  3   0008H   1 = Characters are struck out</span>
<span class="sd">                        0010H 1 = Outline</span>
<span class="sd">                        0020H  1 = Shadow</span>
<span class="sd">    4     2     Colour index</span>
<span class="sd">    6     2     Font weight (100-1000).</span>
<span class="sd">                Standard values are 0190H (400) for normal text and 02BCH</span>
<span class="sd">                (700) for bold text.</span>
<span class="sd">    8     2     Escapement type:</span>
<span class="sd">                  0000H = None</span>
<span class="sd">                  0001H = Superscript</span>
<span class="sd">                  0002H = Subscript</span>
<span class="sd">    10    1     Underline type:</span>
<span class="sd">                  00H = None</span>
<span class="sd">                  01H = Single</span>
<span class="sd">                  21H = Single accounting</span>
<span class="sd">                  02H = Double</span>
<span class="sd">                  22H = Double accounting</span>
<span class="sd">    11    1     Font family:</span>
<span class="sd">                  00H = None (unknown or don&#39;t care)</span>
<span class="sd">                  01H = Roman (variable width, serifed)</span>
<span class="sd">                  02H = Swiss (variable width, sans-serifed)</span>
<span class="sd">                  03H = Modern (fixed width, serifed or sans-serifed)</span>
<span class="sd">                  04H = Script (cursive)</span>
<span class="sd">                  05H = Decorative (specialised, i.e. Old English, Fraktur)</span>
<span class="sd">    12    1     Character set:</span>
<span class="sd">                  00H = 0 = ANSI Latin</span>
<span class="sd">                  01H = 1 = System default</span>
<span class="sd">                  02H = 2 = Symbol</span>
<span class="sd">                  4DH = 77 = Apple Roman</span>
<span class="sd">                  80H = 128 = ANSI Japanese Shift-JIS</span>
<span class="sd">                  81H = 129 = ANSI Korean (Hangul)</span>
<span class="sd">                  82H = 130 = ANSI Korean (Johab)</span>
<span class="sd">                  86H = 134 = ANSI Chinese Simplified GBK</span>
<span class="sd">                  88H = 136 = ANSI Chinese Traditional BIG5</span>
<span class="sd">                  A1H = 161 = ANSI Greek</span>
<span class="sd">                  A2H = 162 = ANSI Turkish</span>
<span class="sd">                  A3H = 163 = ANSI Vietnamese</span>
<span class="sd">                  B1H = 177 = ANSI Hebrew</span>
<span class="sd">                  B2H = 178 = ANSI Arabic</span>
<span class="sd">                  BAH = 186 = ANSI Baltic</span>
<span class="sd">                  CCH = 204 = ANSI Cyrillic</span>
<span class="sd">                  DEH = 222 = ANSI Thai</span>
<span class="sd">                  EEH = 238 = ANSI Latin II (Central European)</span>
<span class="sd">                  FFH = 255 = OEM Latin I</span>
<span class="sd">    13    1     Not used</span>
<span class="sd">    14    var.  Font name:</span>
<span class="sd">                  BIFF5/BIFF7: Byte string, 8-bit string length</span>
<span class="sd">                  BIFF8: Unicode string, 8-bit string length</span>
<span class="sd">    The boldness and underline flags are still set in the options field,</span>
<span class="sd">    but not used on reading the font. Font weight and underline type</span>
<span class="sd">    are specified in separate fields instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0031</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">height</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">colour_index</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">escapement</span><span class="p">,</span>
                    <span class="n">underline</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">charset</span><span class="p">,</span>
                    <span class="n">name</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">uname</span> <span class="o">=</span> <span class="n">upack1</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">uname_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uname</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;5H4B</span><span class="si">%d</span><span class="s">s&#39;</span> <span class="o">%</span> <span class="n">uname_len</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">colour_index</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">escapement</span><span class="p">,</span>
                                                <span class="n">underline</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">charset</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
                                                <span class="n">uname</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="NumberFormatRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.NumberFormatRecord">[docs]</a><span class="k">class</span> <span class="nc">NumberFormatRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Record FORMAT, BIFF8:</span>
<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Format index used in other records</span>
<span class="sd">    2       var.    Number format string (Unicode string, 16-bit string length)</span>

<span class="sd">    From  BIFF5  on,  the built-in number formats will be omitted. The built-in</span>
<span class="sd">    formats  are  dependent  on  the current regional settings of the operating</span>
<span class="sd">    system.  The following table shows which number formats are used by default</span>
<span class="sd">    in  a  US-English  environment.  All indexes from 0 to 163 are reserved for</span>
<span class="sd">    built-in formats. The first user-defined format starts at 164.</span>

<span class="sd">    The built-in number formats, BIFF5-BIFF8</span>

<span class="sd">    Index   Type        Format string</span>
<span class="sd">    0       General     General</span>
<span class="sd">    1       Decimal     0</span>
<span class="sd">    2       Decimal     0.00</span>
<span class="sd">    3       Decimal     #,##0</span>
<span class="sd">    4       Decimal     #,##0.00</span>
<span class="sd">    5       Currency    &quot;$&quot;#,##0_);(&quot;$&quot;#,##</span>
<span class="sd">    6       Currency    &quot;$&quot;#,##0_);[Red](&quot;$&quot;#,##</span>
<span class="sd">    7       Currency    &quot;$&quot;#,##0.00_);(&quot;$&quot;#,##</span>
<span class="sd">    8       Currency    &quot;$&quot;#,##0.00_);[Red](&quot;$&quot;#,##</span>
<span class="sd">    9       Percent     0%</span>
<span class="sd">    10      Percent     0.00%</span>
<span class="sd">    11      Scientific  0.00E+00</span>
<span class="sd">    12      Fraction    # ?/?</span>
<span class="sd">    13      Fraction    # ??/??</span>
<span class="sd">    14      Date        M/D/YY</span>
<span class="sd">    15      Date        D-MMM-YY</span>
<span class="sd">    16      Date        D-MMM</span>
<span class="sd">    17      Date        MMM-YY</span>
<span class="sd">    18      Time        h:mm AM/PM</span>
<span class="sd">    19      Time        h:mm:ss AM/PM</span>
<span class="sd">    20      Time        h:mm</span>
<span class="sd">    21      Time        h:mm:ss</span>
<span class="sd">    22      Date/Time   M/D/YY h:mm</span>
<span class="sd">    37      Account     _(#,##0_);(#,##0)</span>
<span class="sd">    38      Account     _(#,##0_);[Red](#,##0)</span>
<span class="sd">    39      Account     _(#,##0.00_);(#,##0.00)</span>
<span class="sd">    40      Account     _(#,##0.00_);[Red](#,##0.00)</span>
<span class="sd">    41      Currency    _(&quot;$&quot;* #,##0_);_(&quot;$&quot;* (#,##0);_(&quot;$&quot;* &quot;-&quot;_);_(@_)</span>
<span class="sd">    42      Currency    _(* #,##0_);_(* (#,##0);_(* &quot;-&quot;_);_(@_)</span>
<span class="sd">    43      Currency    _(&quot;$&quot;* #,##0.00_);_(&quot;$&quot;* (#,##0.00);_(&quot;$&quot;* &quot;-&quot;??_);_(@_)</span>
<span class="sd">    44      Currency    _(* #,##0.00_);_(* (#,##0.00);_(* &quot;-&quot;??_);_(@_)</span>
<span class="sd">    45      Time        mm:ss</span>
<span class="sd">    46      Time        [h]:mm:ss</span>
<span class="sd">    47      Time        mm:ss.0</span>
<span class="sd">    48      Scientific  ##0.0E+0</span>
<span class="sd">    49      Text        @</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x041E</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">fmtstr</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">ufmtstr</span> <span class="o">=</span> <span class="n">upack2</span><span class="p">(</span><span class="n">fmtstr</span><span class="p">)</span>
        <span class="n">ufmtstr_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ufmtstr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H</span><span class="si">%d</span><span class="s">s&#39;</span> <span class="o">%</span> <span class="n">ufmtstr_len</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ufmtstr</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="XFRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.XFRecord">[docs]</a><span class="k">class</span> <span class="nc">XFRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    XF Substructures</span>
<span class="sd">    -------------------------------------------------------------------------</span>
<span class="sd">    XF_TYPE_PROT  XF Type and Cell Protection (3 Bits), BIFF3-BIFF8</span>
<span class="sd">    These 3 bits are part of a specific data byte.</span>
<span class="sd">    Bit Mask    Contents</span>
<span class="sd">    0   01H     1 = Cell is locked</span>
<span class="sd">    1   02H     1 = Formula is hidden</span>
<span class="sd">    2   04H     0 = Cell XF; 1 = Style XF</span>

<span class="sd">    XF_USED_ATTRIB   Attributes   Used  from  Parent  Style  XF  (6  Bits),</span>
<span class="sd">    BIFF3-BIFF8  Each  bit  describes  the  validity  of  a  specific group</span>
<span class="sd">    of  attributes.  In  cell XFs a cleared bit means the attributes of the</span>
<span class="sd">    parent  style XF are used (but only if the attributes are valid there),</span>
<span class="sd">    a  set  bit  means  the  attributes  of  this XF are used. In style XFs</span>
<span class="sd">    a cleared bit means the attribute setting is valid, a set bit means the</span>
<span class="sd">    attribute should be ignored.</span>
<span class="sd">    Bit Mask    Contents</span>
<span class="sd">    0   01H     Flag for number format</span>
<span class="sd">    1   02H     Flag for font</span>
<span class="sd">    2   04H     Flag for horizontal and vertical alignment, text wrap, indentation, orientation, rotation, and</span>
<span class="sd">                text direction</span>
<span class="sd">    3   08H     Flag for border lines</span>
<span class="sd">    4   10H     Flag for background area style</span>
<span class="sd">    5   20H     Flag for cell protection (cell locked and formula hidden)</span>

<span class="sd">    XF_HOR_ALIGN  Horizontal Alignment (3 Bits), BIFF2-BIFF8 The horizontal</span>
<span class="sd">    alignment consists of 3 bits and is part of a specific data byte.</span>
<span class="sd">    Value   Horizontal alignment</span>
<span class="sd">    00H     General</span>
<span class="sd">    01H     Left</span>
<span class="sd">    02H     Centred</span>
<span class="sd">    03H     Right</span>
<span class="sd">    04H     Filled</span>
<span class="sd">    05H     Justified (BIFF4-BIFF8X)</span>
<span class="sd">    06H     Centred across selection (BIFF4-BIFF8X)</span>
<span class="sd">    07H     Distributed (BIFF8X)</span>

<span class="sd">    XF_VERT_ALIGN Vertical Alignment (2 or 3 Bits), BIFF4-BIFF8</span>
<span class="sd">    The vertical alignment consists of 2 bits (BIFF4) or 3 bits (BIFF5-BIFF8)</span>
<span class="sd">    and is part of a specific data byte. Vertical alignment is not available</span>
<span class="sd">    in BIFF2 and BIFF3.</span>
<span class="sd">    Value   Vertical alignment</span>
<span class="sd">    00H     Top</span>
<span class="sd">    01H     Centred</span>
<span class="sd">    02H     Bottom</span>
<span class="sd">    03H     Justified (BIFF5-BIFF8X)</span>
<span class="sd">    04H     Distributed (BIFF8X)</span>

<span class="sd">    XF_ORIENTATION  Text  Orientation  (2  Bits),  BIFF4-BIFF7  In the BIFF</span>
<span class="sd">    versions  BIFF4-BIFF7,  text  can  be  rotated  in  steps of 90 degrees</span>
<span class="sd">    or  stacked.  The  orientation  mode  consists of 2 bits and is part of</span>
<span class="sd">    a specific data byte. In BIFF8 a rotation angle occurs instead of these</span>
<span class="sd">    flags.</span>
<span class="sd">    Value   Text orientation</span>
<span class="sd">    00H     Not rotated</span>
<span class="sd">    01H     Letters are stacked top-to-bottom, but not rotated</span>
<span class="sd">    02H     Text is rotated 90 degrees counterclockwise</span>
<span class="sd">    03H     Text is rotated 90 degrees clockwise</span>

<span class="sd">    XF_ROTATION Text Rotation Angle (1 Byte), BIFF8</span>
<span class="sd">    Value   Text rotation</span>
<span class="sd">    0       Not rotated</span>
<span class="sd">    1-90    1 to 90 degrees counterclockwise</span>
<span class="sd">    91-180  1 to 90 degrees clockwise</span>
<span class="sd">    255     Letters are stacked top-to-bottom, but not rotated</span>

<span class="sd">    XF_BORDER_34  Cell  Border  Style  (4  Bytes), BIFF3-BIFF4 Cell borders</span>
<span class="sd">    contain a line style and a line colour for each line of the border.</span>
<span class="sd">    Bit     Mask        Contents</span>
<span class="sd">    2-0     00000007H   Top line style</span>
<span class="sd">    7-3     000000F8H   Colour index for top line colour</span>
<span class="sd">    10-8    00000700H   Left line style</span>
<span class="sd">    15-11   0000F800H   Colour index for left line colour</span>
<span class="sd">    18-16   00070000H   Bottom line style</span>
<span class="sd">    23-19   00F80000H   Colour index for bottom line colour</span>
<span class="sd">    26-24   07000000H   Right line style</span>
<span class="sd">    31-27   F8000000H   Colour index for right line colour</span>

<span class="sd">    XF_AREA_34  Cell  Background  Area  Style (2 Bytes), BIFF3-BIFF4 A cell</span>
<span class="sd">    background  area  style  contains  an area pattern and a foreground and</span>
<span class="sd">    background colour.</span>
<span class="sd">    Bit     Mask    Contents</span>
<span class="sd">    5-0     003FH   Fill pattern</span>
<span class="sd">    10-6    07C0H   Colour index for pattern colour</span>
<span class="sd">    15-11   F800H   Colour index for pattern background</span>
<span class="sd"> ---------------------------------------------------------------------------------------------</span>
<span class="sd">    Record XF, BIFF8:</span>
<span class="sd">    Offset      Size    Contents</span>
<span class="sd">    0           2       Index to FONT record</span>
<span class="sd">    2           2       Index to FORMAT record</span>
<span class="sd">    4           2       Bit     Mask    Contents</span>
<span class="sd">                        2-0     0007H   XF_TYPE_PROT . XF type, cell protection (see above)</span>
<span class="sd">                        15-4    FFF0H   Index to parent style XF (always FFFH in style XFs)</span>
<span class="sd">    6           1       Bit     Mask    Contents</span>
<span class="sd">                        2-0     07H     XF_HOR_ALIGN . Horizontal alignment (see above)</span>
<span class="sd">                        3       08H     1 = Text is wrapped at right border</span>
<span class="sd">                        6-4     70H     XF_VERT_ALIGN . Vertical alignment (see above)</span>
<span class="sd">    7           1       XF_ROTATION: Text rotation angle (see above)</span>
<span class="sd">    8           1       Bit     Mask    Contents</span>
<span class="sd">                        3-0     0FH     Indent level</span>
<span class="sd">                        4       10H     1 = Shrink content to fit into cell</span>
<span class="sd">                        5               merge</span>
<span class="sd">                        7-6     C0H     Text direction (BIFF8X only)</span>
<span class="sd">                                        00b = According to context</span>
<span class="sd">                                        01b = Left-to-right</span>
<span class="sd">                                        10b = Right-to-left</span>
<span class="sd">    9           1       Bit     Mask    Contents</span>
<span class="sd">                        7-2     FCH     XF_USED_ATTRIB . Used attributes (see above)</span>
<span class="sd">    10          4       Cell border lines and background area:</span>
<span class="sd">                        Bit     Mask      Contents</span>
<span class="sd">                        3-0     0000000FH Left line style</span>
<span class="sd">                        7-4     000000F0H Right line style</span>
<span class="sd">                        11-8    00000F00H Top line style</span>
<span class="sd">                        15-12   0000F000H Bottom line style</span>
<span class="sd">                        22-16   007F0000H Colour index for left line colour</span>
<span class="sd">                        29-23   3F800000H Colour index for right line colour</span>
<span class="sd">                        30      40000000H 1 = Diagonal line from top left to right bottom</span>
<span class="sd">                        31      80000000H 1 = Diagonal line from bottom left to right top</span>
<span class="sd">    14          4       Bit     Mask      Contents</span>
<span class="sd">                        6-0     0000007FH Colour index for top line colour</span>
<span class="sd">                        13-7    00003F80H Colour index for bottom line colour</span>
<span class="sd">                        20-14   001FC000H Colour index for diagonal line colour</span>
<span class="sd">                        24-21   01E00000H Diagonal line style</span>
<span class="sd">                        31-26   FC000000H Fill pattern</span>
<span class="sd">    18          2       Bit     Mask    Contents</span>
<span class="sd">                        6-0     007FH   Colour index for pattern colour</span>
<span class="sd">                        13-7    3F80H   Colour index for pattern background</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00E0</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span> <span class="n">xftype</span><span class="o">=</span><span class="s">&#39;cell&#39;</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">font_xf_idx</span><span class="p">,</span> <span class="n">fmt_str_xf_idx</span><span class="p">,</span> <span class="n">alignment</span><span class="p">,</span> <span class="n">borders</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">protection</span> <span class="o">=</span> <span class="n">xf</span>
        <span class="n">fnt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">font_xf_idx</span><span class="p">)</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">fmt_str_xf_idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xftype</span> <span class="o">==</span> <span class="s">&#39;cell&#39;</span><span class="p">:</span>
            <span class="n">prt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span>
                <span class="p">((</span><span class="n">protection</span><span class="o">.</span><span class="n">cell_locked</span>    <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
                <span class="p">((</span><span class="n">protection</span><span class="o">.</span><span class="n">formula_hidden</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="mh">0xFFF5</span><span class="p">)</span>
        <span class="n">aln</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span>
            <span class="p">((</span><span class="n">alignment</span><span class="o">.</span><span class="n">horz</span> <span class="o">&amp;</span> <span class="mh">0x07</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">alignment</span><span class="o">.</span><span class="n">wrap</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">alignment</span><span class="o">.</span><span class="n">vert</span> <span class="o">&amp;</span> <span class="mh">0x07</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">rot</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="n">alignment</span><span class="o">.</span><span class="n">rota</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span>
            <span class="p">((</span><span class="n">alignment</span><span class="o">.</span><span class="n">inde</span> <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">alignment</span><span class="o">.</span><span class="n">shri</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">alignment</span><span class="o">.</span><span class="n">merg</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">alignment</span><span class="o">.</span><span class="n">dire</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">xftype</span> <span class="o">==</span> <span class="s">&#39;cell&#39;</span><span class="p">:</span>
            <span class="n">used_attr</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">used_attr</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">borders</span><span class="o">.</span><span class="n">left</span> <span class="o">==</span> <span class="n">borders</span><span class="o">.</span><span class="n">NO_LINE</span><span class="p">:</span>
            <span class="n">borders</span><span class="o">.</span><span class="n">left_colour</span> <span class="o">=</span> <span class="mh">0x00</span>
        <span class="k">if</span> <span class="n">borders</span><span class="o">.</span><span class="n">right</span> <span class="o">==</span> <span class="n">borders</span><span class="o">.</span><span class="n">NO_LINE</span><span class="p">:</span>
            <span class="n">borders</span><span class="o">.</span><span class="n">right_colour</span> <span class="o">=</span> <span class="mh">0x00</span>
        <span class="k">if</span> <span class="n">borders</span><span class="o">.</span><span class="n">top</span> <span class="o">==</span> <span class="n">borders</span><span class="o">.</span><span class="n">NO_LINE</span><span class="p">:</span>
            <span class="n">borders</span><span class="o">.</span><span class="n">top_colour</span> <span class="o">=</span> <span class="mh">0x00</span>
        <span class="k">if</span> <span class="n">borders</span><span class="o">.</span><span class="n">bottom</span> <span class="o">==</span> <span class="n">borders</span><span class="o">.</span><span class="n">NO_LINE</span><span class="p">:</span>
            <span class="n">borders</span><span class="o">.</span><span class="n">bottom_colour</span> <span class="o">=</span> <span class="mh">0x00</span>
        <span class="k">if</span> <span class="n">borders</span><span class="o">.</span><span class="n">diag</span> <span class="o">==</span> <span class="n">borders</span><span class="o">.</span><span class="n">NO_LINE</span><span class="p">:</span>
            <span class="n">borders</span><span class="o">.</span><span class="n">diag_colour</span> <span class="o">=</span> <span class="mh">0x00</span>
        <span class="n">brd1</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L&#39;</span><span class="p">,</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">left</span>          <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">right</span>         <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">top</span>           <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">bottom</span>        <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">left_colour</span>   <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">right_colour</span>  <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">23</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">need_diag1</span>    <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">30</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">need_diag2</span>    <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">31</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">brd2</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L&#39;</span><span class="p">,</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">top_colour</span>    <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">bottom_colour</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span> <span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">diag_colour</span>   <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">borders</span><span class="o">.</span><span class="n">diag</span>          <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">21</span><span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">pattern</span><span class="o">.</span><span class="n">pattern</span>       <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">26</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">pat</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span>
            <span class="p">((</span><span class="n">pattern</span><span class="o">.</span><span class="n">pattern_fore_colour</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">|</span>
            <span class="p">((</span><span class="n">pattern</span><span class="o">.</span><span class="n">pattern_back_colour</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span> <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">fnt</span> <span class="o">+</span> <span class="n">fmt</span> <span class="o">+</span> <span class="n">prt</span> <span class="o">+</span> \
                        <span class="n">aln</span> <span class="o">+</span> <span class="n">rot</span> <span class="o">+</span> <span class="n">txt</span> <span class="o">+</span> <span class="n">used_attr</span> <span class="o">+</span> \
                        <span class="n">brd1</span> <span class="o">+</span> <span class="n">brd2</span> <span class="o">+</span> \
                        <span class="n">pat</span>
</div>
<div class="viewcode-block" id="StyleRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.StyleRecord">[docs]</a><span class="k">class</span> <span class="nc">StyleRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    STYLE record for user-defined cell styles, BIFF3-BIFF8:</span>
<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Bit     Mask    Contents</span>
<span class="sd">                    11-0    0FFFH   Index to style XF record</span>
<span class="sd">                    15      8000H   Always 0 for user-defined styles</span>
<span class="sd">    2       var.    BIFF2-BIFF7: Non-empty byte string, 8-bit string length</span>
<span class="sd">                    BIFF8: Non-empty Unicode string, 16-bit string length</span>
<span class="sd">    STYLE record for built-in cell styles, BIFF3-BIFF8:</span>
<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Bit     Mask    Contents</span>
<span class="sd">                    11-0    0FFFH   Index to style XF record</span>
<span class="sd">                    15      8000H   Always 1 for built-in styles</span>
<span class="sd">    2       1       Identifier of the built-in cell style:</span>
<span class="sd">                        00H = Normal</span>
<span class="sd">                        01H = RowLevel_lv (see next field)</span>
<span class="sd">                        02H = ColLevel_lv (see next field)</span>
<span class="sd">                        03H = Comma</span>
<span class="sd">                        04H = Currency</span>
<span class="sd">                        05H = Percent</span>
<span class="sd">                        06H = Comma [0] (BIFF4-BIFF8)</span>
<span class="sd">                        07H = Currency [0] (BIFF4-BIFF8)</span>
<span class="sd">                        08H = Hyperlink (BIFF8)</span>
<span class="sd">                        09H = Followed Hyperlink (BIFF8)</span>
<span class="sd">    3       1       Level for RowLevel or ColLevel style</span>
<span class="sd">                    (zero-based, lv), FFH otherwise</span>
<span class="sd">    The  RowLevel  and  ColLevel  styles specify the formatting of subtotal</span>
<span class="sd">    cells  in  a specific outline level. The level is specified by the last</span>
<span class="sd">    field  in the STYLE record. Valid values are 0-6 for the outline levels</span>
<span class="sd">    1-7.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0293</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;HBB&#39;</span><span class="p">,</span> <span class="mh">0x8000</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">)</span>
        <span class="c"># TODO: implement user-defined styles???</span>

</div>
<div class="viewcode-block" id="PaletteRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.PaletteRecord">[docs]</a><span class="k">class</span> <span class="nc">PaletteRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  contains  the  definition  of  all  user-defined  colours</span>
<span class="sd">    available for cell and object formatting.</span>

<span class="sd">    Record PALETTE, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Number of following colours (nm). Contains 16 in BIFF3-BIFF4 and 56 in BIFF5-BIFF8.</span>
<span class="sd">    2       4*nm    List of nm RGB colours</span>

<span class="sd">    The following table shows how colour indexes are used in other records:</span>

<span class="sd">    Colour index    Resulting colour or internal list index</span>
<span class="sd">    00H             Built-in Black (R = 00H, G = 00H, B = 00H)</span>
<span class="sd">    01H             Built-in White (R = FFH, G = FFH, B = FFH)</span>
<span class="sd">    02H             Built-in Red (R = FFH, G = 00H, B = 00H)</span>
<span class="sd">    03H             Built-in Green (R = 00H, G = FFH, B = 00H)</span>
<span class="sd">    04H             Built-in Blue (R = 00H, G = 00H, B = FFH)</span>
<span class="sd">    05H             Built-in Yellow (R = FFH, G = FFH, B = 00H)</span>
<span class="sd">    06H             Built-in Magenta (R = FFH, G = 00H, B = FFH)</span>
<span class="sd">    07H             Built-in Cyan (R = 00H, G = FFH, B = FFH)</span>
<span class="sd">    08H             First user-defined colour from the PALETTE record (entry 0 from record colour list)</span>
<span class="sd">    .........................</span>

<span class="sd">    17H (BIFF3-BIFF4) Last user-defined colour from the PALETTE record (entry 15 or 55 from record colour list)</span>
<span class="sd">    3FH (BIFF5-BIFF8)</span>

<span class="sd">    18H (BIFF3-BIFF4) System window text colour for border lines (used in records XF, CF, and</span>
<span class="sd">    40H (BIFF5-BIFF8) WINDOW2 (BIFF8 only))</span>

<span class="sd">    19H (BIFF3-BIFF4) System window background colour for pattern background (used in records XF, and CF)</span>
<span class="sd">    41H (BIFF5-BIFF8)</span>

<span class="sd">    43H             System face colour (dialogue background colour)</span>
<span class="sd">    4DH             System window text colour for chart border lines</span>
<span class="sd">    4EH             System window background colour for chart areas</span>
<span class="sd">    4FH             Automatic colour for chart border lines (seems to be always Black)</span>
<span class="sd">    50H             System ToolTip background colour (used in note objects)</span>
<span class="sd">    51H             System ToolTip text colour (used in note objects)</span>
<span class="sd">    7FFFH           System window text colour for fonts (used in records FONT, EFONT, and CF)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0092</span>

</div>
<div class="viewcode-block" id="BoundSheetRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BoundSheetRecord">[docs]</a><span class="k">class</span> <span class="nc">BoundSheetRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  located  in  the workbook globals area and represents</span>
<span class="sd">    a  sheet  inside  of  the  workbook. For each sheet a BOUNDSHEET record</span>
<span class="sd">    is  written.  It  stores  the sheet name and a stream offset to the BOF</span>
<span class="sd">    record    within   the   workbook   stream.  The  record  is also known</span>
<span class="sd">    as BUNDLESHEET.</span>

<span class="sd">    Record BOUNDSHEET, BIFF5-BIFF8:</span>
<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       4       Absolute stream position of the BOF record of the sheet represented by this record. This</span>
<span class="sd">                    field is never encrypted in protected files.</span>
<span class="sd">    4       1       Visibility:</span>
<span class="sd">                        00H = Visible</span>
<span class="sd">                        01H = Hidden</span>
<span class="sd">                        02H = Strong hidden</span>
<span class="sd">    5       1       Sheet type:</span>
<span class="sd">                        00H = Worksheet</span>
<span class="sd">                        02H = Chart</span>
<span class="sd">                        06H = Visual Basic module</span>
<span class="sd">    6       var.    Sheet name:</span>
<span class="sd">                        BIFF5/BIFF7: Byte string, 8-bit string length</span>
<span class="sd">                        BIFF8: Unicode string, 8-bit string length</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0085</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream_pos</span><span class="p">,</span> <span class="n">visibility</span><span class="p">,</span> <span class="n">sheetname</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">usheetname</span> <span class="o">=</span> <span class="n">upack1</span><span class="p">(</span><span class="n">sheetname</span><span class="p">)</span>
        <span class="n">uusheetname_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">usheetname</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;LBB</span><span class="si">%d</span><span class="s">s&#39;</span> <span class="o">%</span> <span class="n">uusheetname_len</span><span class="p">,</span> <span class="n">stream_pos</span><span class="p">,</span> <span class="n">visibility</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="n">usheetname</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ContinueRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.ContinueRecord">[docs]</a><span class="k">class</span> <span class="nc">ContinueRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Whenever  the content of a record exceeds the given limits (see table),</span>
<span class="sd">    the  record  must  be  split.  Several  CONTINUE records containing the</span>
<span class="sd">    additional data are added after the parent record.</span>

<span class="sd">    BIFF version    Maximum data size of a record</span>
<span class="sd">    BIFF2-BIFF7     2080 bytes (2084 bytes including record header)</span>
<span class="sd">    BIFF8           8224 bytes (8228 bytes including record header) (0x2020)</span>

<span class="sd">    Record CONTINUE, BIFF2-BIFF8:</span>
<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       var.    Data continuation of the previous record</span>

<span class="sd">    Unicode  strings  are  split in a special way. At the beginning of each</span>
<span class="sd">    CONTINUE  record  the option flags byte is repeated. Only the character</span>
<span class="sd">    size  flag  will  be set in this flags byte, the Rich-Text flag and the</span>
<span class="sd">    Far-East  flag  are set to zero. In each CONTINUE record it is possible</span>
<span class="sd">    that  the  character  size  changes  from  8-bit  characters  to 16-bit</span>
<span class="sd">    characters and vice versa.</span>

<span class="sd">    Never  a  Unicode  string  is  split  until  and  including  the  first</span>
<span class="sd">    character.  That means, all header fields (string length, option flags,</span>
<span class="sd">    optional Rich-Text size, and optional Far-East data size) and the first</span>
<span class="sd">    character  of  the string have to occur together in the leading record,</span>
<span class="sd">    or  have  to  be  moved completely into the CONTINUE record. Formatting</span>
<span class="sd">    runs cannot be split between their components (character index and FONT</span>
<span class="sd">    record  index).  If  a string is split between two formatting runs, the</span>
<span class="sd">    option flags field will not be repeated in the CONTINUE record.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x003C</span>

</div>
<div class="viewcode-block" id="SSTRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SSTRecord">[docs]</a><span class="k">class</span> <span class="nc">SSTRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  contains  a  list  of  all  strings  used anywhere in the</span>
<span class="sd">    workbook.  Each string occurs only once. The workbook uses indexes into</span>
<span class="sd">    the list to reference the strings.</span>

<span class="sd">    Record SST, BIFF8:</span>
<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       4       Total number of strings in the workbook (see below)</span>
<span class="sd">    4       4       Number of following strings (nm)</span>
<span class="sd">    8       var.    List of nm Unicode strings, 16-bit string length</span>

<span class="sd">    The  first  field  of  the  SST  record  counts  the  total  occurrence</span>
<span class="sd">    of  strings  in  the  workbook.  For  instance,  the string AAA is used</span>
<span class="sd">    3  times  and  the string BBB is used 2 times. The first field contains</span>
<span class="sd">    5 and the second field contains 2, followed by the two strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00FC</span>

</div>
<div class="viewcode-block" id="ExtSSTRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.ExtSSTRecord">[docs]</a><span class="k">class</span> <span class="nc">ExtSSTRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  occurs  in  conjunction  with  the SST record. It is used</span>
<span class="sd">    by  Excel  to create a hash table with stream offsets to the SST record</span>
<span class="sd">    to optimise string search operations. Excel may not shorten this record</span>
<span class="sd">    if  strings  are deleted from the shared string table, so the last part</span>
<span class="sd">    might  contain  invalid  data. The stream indexes in this record divide</span>
<span class="sd">    the SST into portions containing a constant number of strings.</span>

<span class="sd">    Record EXTSST, BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Number of strings in a portion, this number is &gt;=8</span>
<span class="sd">    2       var.    List of OFFSET structures for all portions. Each OFFSET contains the following data:</span>
<span class="sd">                        Offset Size Contents</span>
<span class="sd">                        0       4   Absolute stream position of first string of the portion</span>
<span class="sd">                        4       2   Position of first string of the portion inside of current record,</span>
<span class="sd">                                    including record header. This counter restarts at zero, if the SST</span>
<span class="sd">                                    record is continued with a CONTINUE record.</span>
<span class="sd">                        6       2   Not used</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00FF</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sst_stream_pos</span><span class="p">,</span> <span class="n">str_placement</span><span class="p">,</span> <span class="n">portions_len</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">extsst</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">abs_stream_pos</span> <span class="o">=</span> <span class="n">sst_stream_pos</span>
        <span class="n">str_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">portion_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">str_counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_placement</span><span class="p">):</span>
            <span class="n">str_chunk_num</span><span class="p">,</span> <span class="n">pos_in_chunk</span> <span class="o">=</span> <span class="n">str_placement</span><span class="p">[</span><span class="n">str_counter</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">str_chunk_num</span> <span class="o">&lt;&gt;</span> <span class="n">portion_counter</span><span class="p">:</span>
                <span class="n">portion_counter</span> <span class="o">=</span> <span class="n">str_chunk_num</span>
                <span class="n">abs_stream_pos</span> <span class="o">+=</span> <span class="n">portions_len</span><span class="p">[</span><span class="n">portion_counter</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c">#print hex(abs_stream_pos)</span>
            <span class="n">str_stream_pos</span> <span class="o">=</span> <span class="n">abs_stream_pos</span> <span class="o">+</span> <span class="n">pos_in_chunk</span> <span class="o">+</span> <span class="mi">4</span> <span class="c"># header</span>
            <span class="n">extsst</span><span class="p">[</span><span class="n">str_counter</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_in_chunk</span><span class="p">,</span> <span class="n">str_stream_pos</span><span class="p">)</span>
            <span class="n">str_counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">exsst_str_count_delta</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_placement</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="o">/</span><span class="mh">0x2000</span><span class="p">)</span> <span class="c"># maybe smth else?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">exsst_str_count_delta</span><span class="p">)</span>
        <span class="n">str_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">str_counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_placement</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;IHH&#39;</span><span class="p">,</span> <span class="n">extsst</span><span class="p">[</span><span class="n">str_counter</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">extsst</span><span class="p">[</span><span class="n">str_counter</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">str_counter</span> <span class="o">+=</span> <span class="n">exsst_str_count_delta</span>
</div>
<div class="viewcode-block" id="DimensionsRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.DimensionsRecord">[docs]</a><span class="k">class</span> <span class="nc">DimensionsRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Record DIMENSIONS, BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       4       Index to first used row</span>
<span class="sd">    4       4       Index to last used row, increased by 1</span>
<span class="sd">    8       2       Index to first used column</span>
<span class="sd">    10      2       Index to last used column, increased by 1</span>
<span class="sd">    12      2       Not used</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0200</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_used_row</span><span class="p">,</span> <span class="n">last_used_row</span><span class="p">,</span> <span class="n">first_used_col</span><span class="p">,</span> <span class="n">last_used_col</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2L3H&#39;</span><span class="p">,</span>
                                            <span class="n">first_used_row</span><span class="p">,</span> <span class="n">last_used_row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                            <span class="n">first_used_col</span><span class="p">,</span> <span class="n">last_used_col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                            <span class="mh">0x00</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Window2Record"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.Window2Record">[docs]</a><span class="k">class</span> <span class="nc">Window2Record</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Record WINDOW2, BIFF8:</span>

<span class="sd">    Offset  Size Contents</span>
<span class="sd">    0       2 Option flags (see below)</span>
<span class="sd">    2       2 Index to first visible row</span>
<span class="sd">    4       2 Index to first visible column</span>
<span class="sd">    6       2 Colour index of grid line colour. Note that in BIFF2-BIFF7 an RGB colour is</span>
<span class="sd">                written instead.</span>
<span class="sd">    8       2 Not used</span>
<span class="sd">    10      2 Cached magnification factor in page break preview (in percent); 0 = Default (60%)</span>
<span class="sd">    12      2 Cached magnification factor in normal view (in percent); 0 = Default (100%)</span>
<span class="sd">    14      4 Not used</span>

<span class="sd">    In  BIFF8  this record stores used magnification factors for page break</span>
<span class="sd">    preview  and  normal  view.  These  values  are  used  to  restore  the</span>
<span class="sd">    magnification,  when the view is changed. The real magnification of the</span>
<span class="sd">    currently  active  view  is  stored  in the SCL record. The type of the</span>
<span class="sd">    active view is stored in the option flags field (see below).</span>

<span class="sd">     0 0001H 0 = Show formula results 1 = Show formulas</span>
<span class="sd">     1 0002H 0 = Do not show grid lines 1 = Show grid lines</span>
<span class="sd">     2 0004H 0 = Do not show sheet headers 1 = Show sheet headers</span>
<span class="sd">     3 0008H 0 = Panes are not frozen 1 = Panes are frozen (freeze)</span>
<span class="sd">     4 0010H 0 = Show zero values as empty cells 1 = Show zero values</span>
<span class="sd">     5 0020H 0 = Manual grid line colour 1 = Automatic grid line colour</span>
<span class="sd">     6 0040H 0 = Columns from left to right 1 = Columns from right to left</span>
<span class="sd">     7 0080H 0 = Do not show outline symbols 1 = Show outline symbols</span>
<span class="sd">     8 0100H 0 = Keep splits if pane freeze is removed 1 = Remove splits if pane freeze is removed</span>
<span class="sd">     9 0200H 0 = Sheet not selected 1 = Sheet selected (BIFF5-BIFF8)</span>
<span class="sd">    10 0400H 0 = Sheet not visible 1 = Sheet visible (BIFF5-BIFF8)</span>
<span class="sd">    11 0800H 0 = Show in normal view 1 = Show in page break preview (BIFF8)</span>

<span class="sd">    The freeze flag specifies, if a following PANE record describes unfrozen or frozen panes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x023E</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">first_visible_row</span><span class="p">,</span> <span class="n">first_visible_col</span><span class="p">,</span> <span class="n">grid_colour</span><span class="p">,</span> <span class="n">preview_magn</span><span class="p">,</span> <span class="n">normal_magn</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;7HL&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span>
                                    <span class="n">first_visible_row</span><span class="p">,</span> <span class="n">first_visible_col</span><span class="p">,</span>
                                    <span class="n">grid_colour</span><span class="p">,</span>
                                    <span class="mh">0x00</span><span class="p">,</span>
                                    <span class="n">preview_magn</span><span class="p">,</span> <span class="n">normal_magn</span><span class="p">,</span>
                                    <span class="mh">0x00</span><span class="n">L</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="PanesRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.PanesRecord">[docs]</a><span class="k">class</span> <span class="nc">PanesRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record stores the position of window panes. It is part of the Sheet</span>
<span class="sd">    View Settings Block. If the sheet does not contain any splits, this</span>
<span class="sd">    record will not occur.</span>
<span class="sd">    A sheet can be split in two different ways, with unfrozen panes or with</span>
<span class="sd">    frozen panes. A flag in the WINDOW2 record specifies, if the panes are</span>
<span class="sd">    frozen, which affects the contents of this record.</span>

<span class="sd">    Record PANE, BIFF2-BIFF8:</span>
<span class="sd">    Offset      Size        Contents</span>
<span class="sd">    0           2           Position of the vertical split</span>
<span class="sd">                            (px, 0 = No vertical split):</span>
<span class="sd">                            Unfrozen pane: Width of the left pane(s)</span>
<span class="sd">                            (in twips = 1/20 of a point)</span>
<span class="sd">                            Frozen pane: Number of visible</span>
<span class="sd">                            columns in left pane(s)</span>
<span class="sd">    2           2           Position of the horizontal split</span>
<span class="sd">                            (py, 0 = No horizontal split):</span>
<span class="sd">                            Unfrozen pane: Height of the top pane(s)</span>
<span class="sd">                            (in twips = 1/20 of a point)</span>
<span class="sd">                            Frozen pane: Number of visible</span>
<span class="sd">                            rows in top pane(s)</span>
<span class="sd">    4           2           Index to first visible row</span>
<span class="sd">                            in bottom pane(s)</span>
<span class="sd">    6           2           Index to first visible column</span>
<span class="sd">                            in right pane(s)</span>
<span class="sd">    8           1           Identifier of pane with active</span>
<span class="sd">                            cell cursor</span>
<span class="sd">    [9]         1           Not used (BIFF5-BIFF8 only, not written</span>
<span class="sd">                            in BIFF2-BIFF4)</span>

<span class="sd">    If the panes are frozen, pane 0 is always active, regardless</span>
<span class="sd">    of the cursor position. The correct identifiers for all possible</span>
<span class="sd">    combinations of visible panes are shown in the following pictures.</span>

<span class="sd">    px = 0, py = 0                  px = 0, py &gt; 0</span>
<span class="sd">    --------------------------      ------------|-------------</span>
<span class="sd">    |                        |      |                        |</span>
<span class="sd">    |                        |      |           3            |</span>
<span class="sd">    |                        |      |                        |</span>
<span class="sd">    -           3            -      --------------------------</span>
<span class="sd">    |                        |      |                        |</span>
<span class="sd">    |                        |      |           2            |</span>
<span class="sd">    |                        |      |                        |</span>
<span class="sd">    --------------------------      ------------|-------------</span>

<span class="sd">    px &gt; 0, py = 0                  px &gt; 0, py &gt; 0</span>
<span class="sd">    ------------|-------------      ------------|-------------</span>
<span class="sd">    |           |            |      |           |            |</span>
<span class="sd">    |           |            |      |     3     |      2     |</span>
<span class="sd">    |           |            |      |           |            |</span>
<span class="sd">    -     3     |      1     -      --------------------------</span>
<span class="sd">    |           |            |      |           |            |</span>
<span class="sd">    |           |            |      |     1     |      0     |</span>
<span class="sd">    |           |            |      |           |            |</span>
<span class="sd">    ------------|-------------      ------------|-------------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0041</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">first_row_bottom</span><span class="p">,</span> <span class="n">first_col_right</span><span class="p">,</span> <span class="n">active_pane</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;5H&#39;</span><span class="p">,</span>
                                            <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span>
                                            <span class="n">first_row_bottom</span><span class="p">,</span> <span class="n">first_col_right</span><span class="p">,</span>
                                            <span class="n">active_pane</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="RowRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.RowRecord">[docs]</a><span class="k">class</span> <span class="nc">RowRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  contains  the properties of a single row in a sheet. Rows</span>
<span class="sd">    and cells in a sheet are divided into blocks of 32 rows.</span>

<span class="sd">    Record ROW, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Index of this row</span>
<span class="sd">    2       2       Index to column of the first cell which is described by a cell record</span>
<span class="sd">    4       2       Index to column of the last cell which is described by a cell record,</span>
<span class="sd">                    increased by 1</span>
<span class="sd">    6       2       Bit     Mask    Contents</span>
<span class="sd">                    14-0    7FFFH   Height of the row, in twips = 1/20 of a point</span>
<span class="sd">                    15      8000H   0 = Row has custom height; 1 = Row has default height</span>
<span class="sd">    8       2       Not used</span>
<span class="sd">    10      2       In BIFF3-BIFF4 this field contains a relative offset</span>
<span class="sd">                    to calculate stream position of the first cell record</span>
<span class="sd">                    for this row. In BIFF5-BIFF8 this field is not used</span>
<span class="sd">                    anymore, but the DBCELL record instead.</span>
<span class="sd">    12      4       Option flags and default row formatting:</span>
<span class="sd">                    Bit     Mask        Contents</span>
<span class="sd">                    2-0     00000007H   Outline level of the row</span>
<span class="sd">                    4       00000010H   1 = Outline group starts or ends here (depending</span>
<span class="sd">                                        on where the outline buttons are located,</span>
<span class="sd">                                        see WSBOOL record), and is collapsed</span>
<span class="sd">                    5       00000020H   1 = Row is hidden (manually, or by a filter or outline group)</span>
<span class="sd">                    6       00000040H   1 = Row height and default font height do not match</span>
<span class="sd">                    7       00000080H   1 = Row has explicit default format (fl)</span>
<span class="sd">                    8       00000100H   Always 1</span>
<span class="sd">                    27-16   0FFF0000H   If fl=1: Index to default XF record</span>
<span class="sd">                    28      10000000H   1 = Additional space above the row. This flag is set,</span>
<span class="sd">                                        if the upper border of at least one cell in this row</span>
<span class="sd">                                        or if the lower border of at least one cell in the row</span>
<span class="sd">                                        above is formatted with a thick line style.</span>
<span class="sd">                                        Thin and medium line styles are not taken into account.</span>
<span class="sd">                    29      20000000H   1 = Additional space below the row. This flag is set,</span>
<span class="sd">                                        if the lower border of at least one cell in this row</span>
<span class="sd">                                        or if the upper border of at least one cell in the row</span>
<span class="sd">                                        below is formatted with a medium or thick line style.</span>
<span class="sd">                                        Thin line styles are not taken into account.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0208</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span> <span class="n">last_col</span><span class="p">,</span> <span class="n">height_options</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;6HL&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span> <span class="n">last_col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                                        <span class="n">height_options</span><span class="p">,</span>
                                        <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span>
                                        <span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LabelSSTRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.LabelSSTRecord">[docs]</a><span class="k">class</span> <span class="nc">LabelSSTRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record represents a cell that contains a string. It replaces the</span>
<span class="sd">    LABEL record and RSTRING record used in BIFF2-BIFF7.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00FD</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_idx</span><span class="p">,</span> <span class="n">sst_idx</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3HL&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_idx</span><span class="p">,</span> <span class="n">sst_idx</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="MergedCellsRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.MergedCellsRecord">[docs]</a><span class="k">class</span> <span class="nc">MergedCellsRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record contains all merged cell ranges of the current sheet.</span>

<span class="sd">    Record MERGEDCELLS, BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       var.    Cell range address list with all merged ranges</span>

<span class="sd">    ------------------------------------------------------------------</span>

<span class="sd">    A cell range address list consists of a field with the number of ranges</span>
<span class="sd">    and the list of the range addresses.</span>

<span class="sd">    Cell range address list, BIFF8:</span>

<span class="sd">    Offset  Size            Contents</span>
<span class="sd">    0       2               Number of following cell range addresses (nm)</span>
<span class="sd">    2       8*nm            List of nm cell range addresses</span>

<span class="sd">    ---------------------------------------------------------------------</span>
<span class="sd">    Cell range address, BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Index to first row</span>
<span class="sd">    2       2       Index to last row</span>
<span class="sd">    4       2       Index to first column</span>
<span class="sd">    6       2       Index to last column</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00E5</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">merged_list</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">merged</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mh">0x403</span><span class="p">):</span>
                <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">merged_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">merged</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4H&#39;</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_REC_ID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> \
                                    <span class="n">merged</span>

    <span class="c"># for some reason Excel doesn&#39;t use CONTINUE</span>
<div class="viewcode-block" id="MergedCellsRecord.get"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.MergedCellsRecord.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span>
</div></div>
<div class="viewcode-block" id="MulBlankRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.MulBlankRecord">[docs]</a><span class="k">class</span> <span class="nc">MulBlankRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  represents  a  cell  range  of empty cells. All cells are</span>
<span class="sd">    located in the same row.</span>

<span class="sd">    Record MULBLANK, BIFF5-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Index to row</span>
<span class="sd">    2       2       Index to first column (fc)</span>
<span class="sd">    4       2*nc    List of nc=lc-fc+1 16-bit indexes to XF records</span>
<span class="sd">    4+2*nc  2       Index to last column (lc)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00BE</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span> <span class="n">last_col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">blanks_count</span> <span class="o">=</span> <span class="n">last_col</span><span class="o">-</span><span class="n">first_col</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">H&#39;</span> <span class="o">%</span> <span class="n">blanks_count</span><span class="p">,</span> <span class="o">*</span><span class="p">([</span><span class="n">xf_index</span><span class="p">]</span><span class="o">*</span><span class="n">blanks_count</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2H&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">first_col</span><span class="p">)</span> <span class="o">+</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span>  <span class="n">last_col</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="BlankRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BlankRecord">[docs]</a><span class="k">class</span> <span class="nc">BlankRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  represents  an empty cell.</span>

<span class="sd">    Record BLANK, BIFF5-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Index to row</span>
<span class="sd">    2       2       Index to first column (fc)</span>
<span class="sd">    4       2       indexes to XF record</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0201</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3H&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="RKRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.RKRecord">[docs]</a><span class="k">class</span> <span class="nc">RKRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record represents a cell that contains an RK value (encoded integer or</span>
<span class="sd">    floating-point value). If a floating-point value cannot be encoded to an RK value,</span>
<span class="sd">    a NUMBER record will be written.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x027E</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">rk_encoded</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3HI&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">rk_encoded</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="NumberRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.NumberRecord">[docs]</a><span class="k">class</span> <span class="nc">NumberRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record represents a cell that contains an IEEE-754 floating-point value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0203</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3Hd&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="StringRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.StringRecord">[docs]</a><span class="k">class</span> <span class="nc">StringRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Offset     Size   Contents</span>
<span class="sd">    0       1 or 2  Length of the string (character count, ln)</span>
<span class="sd">    1 or 2      1     Option flags:</span>
<span class="sd">                     Bit       Mask Contents</span>
<span class="sd">                                01H</span>
<span class="sd">                      0                  Character compression (ccompr):</span>
<span class="sd">                                         02 = Compressed (8-bit characters)</span>
<span class="sd">                                         12 = Uncompressed (16-bit characters)</span>
<span class="sd">                                04H</span>
<span class="sd">                      2                  Asian phonetic settings (phonetic):</span>
<span class="sd">                                         02 = Does not contain Asian phonetic settings</span>
<span class="sd">                                         12 = Contains Asian phonetic settings</span>
<span class="sd">                                08H</span>
<span class="sd">                      3                  Rich-Text settings (richtext):</span>
<span class="sd">                                         02 = Does not contain Rich-Text settings</span>
<span class="sd">                                         12 = Contains Rich-Text settings</span>
<span class="sd">    [2 or 3]     2     (optional, only if richtext=1) Number of Rich-Text formatting runs (rt)</span>
<span class="sd">    [var.]      4     (optional, only if phonetic=1) Size of Asian phonetic settings block (in bytes, sz)</span>
<span class="sd">    var.   ln or 2ln Character array (8-bit characters or 16-bit characters, dependent on ccompr)</span>
<span class="sd">    [var.]    4rt     (optional, only if richtext=1) List of rt formatting runs (3.2)</span>
<span class="sd">            sz</span>
<span class="sd">    [var.]            (optional, only if phonetic=1) Asian Phonetic Settings Block (3.4.2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0207</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">uncompressed</span> <span class="o">=</span> <span class="mh">0x01</span>
        <span class="n">asian_phonetic_settings</span> <span class="o">=</span> <span class="mh">0x04</span>
        <span class="n">rich_text_settings</span> <span class="o">=</span> <span class="mh">0x08</span>
        
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;UTF-16le&#39;</span><span class="p">)</span>
        <span class="n">slen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">uncompressed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)):</span>
            <span class="c"># if high bytes are all zero, do string compression</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">slen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">options</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">uncompressed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;HB</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">slen</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="FormulaRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.FormulaRecord">[docs]</a><span class="k">class</span> <span class="nc">FormulaRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Offset Size Contents</span>
<span class="sd">    0      2    Index to row</span>
<span class="sd">    2      2    Index to column</span>
<span class="sd">    4      2    Index to XF record</span>
<span class="sd">    6      8    Result of the formula</span>
<span class="sd">    14     2    Option flags:</span>
<span class="sd">                Bit Mask    Contents</span>
<span class="sd">                0   0001H   1 = Recalculate always</span>
<span class="sd">                1   0002H   1 = Calculate on open</span>
<span class="sd">                3   0008H   1 = Part of a shared formula</span>
<span class="sd">    16     4    Not used</span>
<span class="sd">    20     var. Formula data (RPN token array)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0006</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="n">rpn</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c"># for an empty cell</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3HQHL&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">rpn</span>

</div>
<div class="viewcode-block" id="HyperlinkRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.HyperlinkRecord">[docs]</a><span class="k">class</span> <span class="nc">HyperlinkRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Each HLINK record starts with the same data items and continues with</span>
<span class="sd">    special data related to the current type of hyperlink. It starts with a</span>
<span class="sd">    cell range. Each cell of this range will contain the same hyperlink.</span>

<span class="sd">    Record HLINK, BIFF8:</span>
<span class="sd">   Offset            Size        Contents</span>
<span class="sd">       0               8         Cell range address of all cells containing this hyperlink (3.13.1)</span>
<span class="sd">       8              16         GUID of StdLink:</span>
<span class="sd">                                 D0H C9H EAH 79H F9H BAH CEH 11H 8CH 82H 00H AAH 00H 4BH A9H 0BH</span>
<span class="sd">                                 (79EAC9D0-BAF9-11CE-8C82-00AA004BA90B)</span>
<span class="sd">      24               4         Unknown value: 00000002H</span>
<span class="sd">      28               4        Option flags (see below)</span>
<span class="sd">     [32]              4        (optional, see option flags) Character count of description text, including trailing zero word</span>
<span class="sd">                                (dl)</span>
<span class="sd">     [36]            2dl        (optional, see option flags) Character array of description text, no Unicode string header,</span>
<span class="sd">                                always 16-bit characters, zero-terminated</span>
<span class="sd">    [var.]             4        (optional, see option flags) Character count of target frame, including trailing zero word</span>
<span class="sd">                                (fl)</span>
<span class="sd">    [var.]           2fl         (optional, see option flags) Character array of target frame, no Unicode string header,</span>
<span class="sd">                                 always 16-bit characters, zero-terminated</span>
<span class="sd">     var.            var.        Special data (6.53.2 and following)</span>
<span class="sd">    [var.]             4         (optional, see option flags) Character count of the text mark, including trailing zero word</span>
<span class="sd">                                 (tl)</span>
<span class="sd">    [var.]           2tl         (optional, see option flags) Character array of the text mark without &quot;#&quot; sign, no Unicode</span>
<span class="sd">                                 string header, always 16-bit characters, zero-terminated</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x01B8</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frow</span><span class="p">,</span> <span class="n">lrow</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">lcol</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="mh">0x00</span>
        <span class="n">special</span><span class="o">=</span><span class="bp">None</span>
        <span class="n">textmark</span><span class="o">=</span><span class="bp">None</span>
        
        <span class="c">#~ assert url is not None or textmark is not None, &#39;must specify either url or textmark arguments&#39;</span>
        
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">|=</span> <span class="mh">0x14</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;UTF-16le&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span>
        
        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">|=</span> <span class="mh">0x80</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;UTF-16le&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span>
        
        <span class="n">u16url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;UTF-16le&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span>
        <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">url</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c"># hyperlink containing a URL (6.53.2)</span>
            <span class="k">assert</span> <span class="n">url</span><span class="p">[:</span><span class="n">url</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">(),</span> <span class="s">&#39;not valid URL&#39;</span><span class="o">%</span><span class="n">url</span>
            <span class="n">options</span> <span class="o">|=</span> <span class="mh">0x03</span>
            <span class="n">special</span>  <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4L&#39;</span><span class="p">,</span> <span class="mh">0x79eac9e0</span><span class="p">,</span> <span class="mh">0x11cebaf9</span><span class="p">,</span> <span class="mh">0xaa00828c</span><span class="p">,</span> <span class="mh">0x0ba94b00</span><span class="p">)</span>
            <span class="n">special</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">u16url</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">u16url</span><span class="p">),</span> <span class="n">u16url</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,):</span>
            <span class="c"># hyperlink to the current workbook (6.53.3)</span>
            <span class="n">options</span> <span class="o">|=</span> <span class="mh">0x01</span>
            
            <span class="n">uplvl_cnt</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">url</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">):</span>
                <span class="c"># this is an absolute path</span>
                <span class="n">options</span> <span class="o">|=</span> <span class="mh">0x02</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">uplvl_cnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;..</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">):</span>
                    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="n">url</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\x00</span><span class="s">&#39;</span>
            
            <span class="n">special</span>  <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4L&#39;</span><span class="p">,</span> <span class="mh">0x00000303</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x000000C0</span><span class="p">,</span> <span class="mh">0x46000000</span><span class="p">)</span>
            <span class="n">special</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;HL</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="n">uplvl_cnt</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="n">url</span><span class="p">)</span>
            <span class="n">special</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4s20x&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\xff\xff\xad\xde</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="c"># I don&#39;t understand the first field here, setting to zero is safe</span>
            <span class="c"># till I figure out what it is</span>
            <span class="n">special</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;LL2s</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">u16url</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">u16url</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]),</span> 
                            <span class="s">&#39;</span><span class="se">\x03\x00</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">u16url</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\\\\</span><span class="s">&#39;</span><span class="p">):</span>
            <span class="c"># hyperlink to a File with UNC Path (6.53.4)</span>
            <span class="n">options</span> <span class="o">|=</span> <span class="mh">0x103</span>
            <span class="n">special</span>  <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">u16url</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">u16url</span><span class="p">),</span> <span class="n">u16url</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">):</span>
            <span class="c"># hyperlink to the current workbook (6.53.5)</span>
            <span class="n">options</span> <span class="o">|=</span> <span class="mh">0x08</span>
            <span class="n">textmark</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        
        <span class="k">if</span> <span class="n">textmark</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">textmark</span> <span class="o">=</span> <span class="n">textmark</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;UTF-16le&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\x00\x00</span><span class="s">&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span>  <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4H&#39;</span><span class="p">,</span> <span class="n">frow</span><span class="p">,</span> <span class="n">lrow</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">lcol</span><span class="p">)</span>
        <span class="c"># GUID of StdLink</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4L&#39;</span><span class="p">,</span> <span class="mh">0x79eac9d0</span><span class="p">,</span> <span class="mh">0x11cebaf9</span><span class="p">,</span> <span class="mh">0xaa00828c</span><span class="p">,</span> <span class="mh">0x0ba94b00</span><span class="p">)</span>
        <span class="c">#~ self._rec_data += &#39;\xd0\xc9\xea\x79\xf9\xba\xce\x11\x8c\x82\x00\xaa\x00\x4b\xa9\x0b&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;LL&#39;</span><span class="p">,</span>   <span class="mh">0x2</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">description</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">description</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">special</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">special</span><span class="p">),</span> <span class="n">special</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">textmark</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;L</span><span class="si">%d</span><span class="s">s&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">textmark</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">textmark</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">textmark</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="QuicktipRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.QuicktipRecord">[docs]</a><span class="k">class</span> <span class="nc">QuicktipRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record contains the cell range and text for a tool tip. It occurs in</span>
<span class="sd">    conjunction with the HLINK record for hyperlinks (6.53) in the Hyperlink</span>
<span class="sd">    Table (5.13). This record is only available in Excel 9.0 (Excel 2000) and</span>
<span class="sd">    later.</span>

<span class="sd">    Record QUICKTIP, BIFF8:</span>

<span class="sd">    Offset Size Contents</span>
<span class="sd">    0      2   0800H (repeated record identifier)</span>
<span class="sd">    2      8   Cell range address of all cells containing the tool tip (3.13.1)</span>
<span class="sd">    10    var. Character array of the tool tip, no Unicode string header, always 16-bit characters, zero-</span>
<span class="sd">            terminated</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0800</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frow</span><span class="p">,</span> <span class="n">lrow</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">lcol</span><span class="p">,</span> <span class="n">hint</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="n">hint</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;UTF-16le&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;5H</span><span class="si">%d</span><span class="s">sx&#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">hint</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_REC_ID</span><span class="p">,</span> <span class="n">frow</span><span class="p">,</span> <span class="n">lrow</span><span class="p">,</span> <span class="n">fcol</span><span class="p">,</span> <span class="n">lcol</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="GutsRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.GutsRecord">[docs]</a><span class="k">class</span> <span class="nc">GutsRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record contains information about the layout of outline symbols.</span>

<span class="sd">    Record GUTS, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Width of the area to display row outlines (left of the sheet), in pixel</span>
<span class="sd">    2       2       Height of the area to display column outlines (above the sheet), in pixel</span>
<span class="sd">    4       2       Number of visible row outline levels (used row levels + 1; or 0, if not used)</span>
<span class="sd">    6       2       Number of visible column outline levels (used column levels + 1; or 0, if not used)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0080</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row_gut_width</span><span class="p">,</span> <span class="n">col_gut_height</span><span class="p">,</span> <span class="n">row_visible_levels</span><span class="p">,</span> <span class="n">col_visible_levels</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;4H&#39;</span><span class="p">,</span> <span class="n">row_gut_width</span><span class="p">,</span> <span class="n">col_gut_height</span><span class="p">,</span> <span class="n">row_visible_levels</span><span class="p">,</span> <span class="n">col_visible_levels</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="WSBoolRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.WSBoolRecord">[docs]</a><span class="k">class</span> <span class="nc">WSBoolRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record stores a 16 bit value with Boolean options for the current</span>
<span class="sd">    sheet.  From BIFF5 on the &quot;Save external linked values&quot; option is moved</span>
<span class="sd">    to the record BOOKBOOL.</span>

<span class="sd">    Option flags of record WSBOOL, BIFF3-BIFF8:</span>

<span class="sd">    Bit     Mask    Contents</span>
<span class="sd">    0       0001H   0 = Do not show automatic page breaks</span>
<span class="sd">                    1 = Show automatic page breaks</span>
<span class="sd">    4       0010H   0 = Standard sheet</span>
<span class="sd">                    1 = Dialogue sheet (BIFF5-BIFF8)</span>
<span class="sd">    5       0020H   0 = No automatic styles in outlines</span>
<span class="sd">                    1 = Apply automatic styles to outlines</span>
<span class="sd">    6       0040H   0 = Outline buttons above outline group</span>
<span class="sd">                    1 = Outline buttons below outline group</span>
<span class="sd">    7       0080H   0 = Outline buttons left of outline group</span>
<span class="sd">                    1 = Outline buttons right of outline group</span>
<span class="sd">    8       0100H   0 = Scale printout in percent</span>
<span class="sd">                    1 = Fit printout to number of pages</span>
<span class="sd">    9       0200H   0 = Save external linked values (BIFF3?BIFF4 only)</span>
<span class="sd">                    1 = Do not save external linked values (BIFF3?BIFF4 only)</span>
<span class="sd">    10      0400H   0 = Do not show row outline symbols</span>
<span class="sd">                    1 = Show row outline symbols</span>
<span class="sd">    11      0800H   0 = Do not show column outline symbols</span>
<span class="sd">                    1 = Show column outline symbols</span>
<span class="sd">    13-12   3000H   These flags specify the arrangement of windows.</span>
<span class="sd">                    They are stored in BIFF4 only.</span>
<span class="sd">                    00 = Arrange windows tiled</span>
<span class="sd">                    01 = Arrange windows horizontal</span>
<span class="sd">                    10 = Arrange windows vertical112 = Arrange windows cascaded</span>
<span class="sd">    The following flags are valid for BIFF4-BIFF8 only:</span>
<span class="sd">    14      4000H   0 = Standard expression evaluation</span>
<span class="sd">                    1 = Alternative expression evaluation</span>
<span class="sd">    15      8000H   0 = Standard formula entries</span>
<span class="sd">                    1 = Alternative formula entries</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0081</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ColInfoRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.ColInfoRecord">[docs]</a><span class="k">class</span> <span class="nc">ColInfoRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record specifies the width for a given range of columns.</span>
<span class="sd">    If a column does not have a corresponding COLINFO record,</span>
<span class="sd">    the width specified in the record STANDARDWIDTH is used. If</span>
<span class="sd">    this record is also not present, the contents of the record</span>
<span class="sd">    DEFCOLWIDTH is used instead.</span>
<span class="sd">    This record also specifies a default XF record to use for</span>
<span class="sd">    cells in the columns that are not described by any cell record</span>
<span class="sd">    (which contain the XF index for that cell). Additionally,</span>
<span class="sd">    the option flags field contains hidden, outline, and collapsed</span>
<span class="sd">    options applied at the columns.</span>

<span class="sd">    Record COLINFO, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Index to first column in the range</span>
<span class="sd">    2       2       Index to last column in the range</span>
<span class="sd">    4       2       Width of the columns in 1/256 of the width of the zero character, using default font</span>
<span class="sd">                    (first FONT record in the file)</span>
<span class="sd">    6       2       Index to XF record for default column formatting</span>
<span class="sd">    8       2       Option flags:</span>
<span class="sd">                    Bits    Mask    Contents</span>
<span class="sd">                    0       0001H   1 = Columns are hidden</span>
<span class="sd">                    10-8    0700H   Outline level of the columns (0 = no outline)</span>
<span class="sd">                    12      1000H   1 = Columns are collapsed</span>
<span class="sd">    10      2       Not used</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x007D</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span> <span class="n">last_col</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;6H&#39;</span><span class="p">,</span> <span class="n">first_col</span><span class="p">,</span> <span class="n">last_col</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">xf_index</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CalcModeRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.CalcModeRecord">[docs]</a><span class="k">class</span> <span class="nc">CalcModeRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the Calculation Settings Block.</span>
<span class="sd">    It specifies whether to calculate formulas manually,</span>
<span class="sd">    automatically or automatically except for multiple table operations.</span>

<span class="sd">    Record CALCMODE, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       FFFFH = automatic except for multiple table operations</span>
<span class="sd">                    0000H = manually</span>
<span class="sd">                    0001H = automatically (default)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x000D</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calc_mode</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;h&#39;</span><span class="p">,</span> <span class="n">calc_mode</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="CalcCountRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.CalcCountRecord">[docs]</a><span class="k">class</span> <span class="nc">CalcCountRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the Calculation Settings Block. It specifies the maximum</span>
<span class="sd">    number of times the formulas should be iteratively calculated. This is a fail-safe</span>
<span class="sd">    against mutually recursive formulas locking up a spreadsheet application.</span>

<span class="sd">    Record CALCCOUNT, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Maximum number of iterations allowed in circular references</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x000C</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calc_count</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">calc_count</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="RefModeRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.RefModeRecord">[docs]</a><span class="k">class</span> <span class="nc">RefModeRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the Calculation Settings Block.</span>
<span class="sd">    It stores which method is used to show cell addresses in formulas.</span>
<span class="sd">    The “RC” mode uses numeric indexes for rows and columns,</span>
<span class="sd">    i.e. “R(1)C(-1)”, or “R1C1:R2C2”.</span>
<span class="sd">    The “A1” mode uses characters for columns and numbers for rows,</span>
<span class="sd">    i.e. “B1”, or “$A$1:$B$2”.</span>

<span class="sd">    Record REFMODE, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = RC mode; 1 = A1 mode</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00F</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref_mode</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">ref_mode</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IterationRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.IterationRecord">[docs]</a><span class="k">class</span> <span class="nc">IterationRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the Calculation Settings Block.</span>
<span class="sd">    It stores if iterations are allowed while calculating recursive formulas.</span>

<span class="sd">    Record ITERATION, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Iterations off; 1 = Iterations on</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x011</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterations_on</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">iterations_on</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DeltaRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.DeltaRecord">[docs]</a><span class="k">class</span> <span class="nc">DeltaRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the Calculation Settings Block.</span>
<span class="sd">    It stores the maximum change of the result to exit an iteration.</span>

<span class="sd">    Record DELTA, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       8       Maximum change in iteration</span>
<span class="sd">                    (IEEE 754 floating-point value,</span>
<span class="sd">                     64bit double precision)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x010</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;d&#39;</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SaveRecalcRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SaveRecalcRecord">[docs]</a><span class="k">class</span> <span class="nc">SaveRecalcRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the Calculation Settings Block.</span>
<span class="sd">    It contains the “Recalculate before save” option in</span>
<span class="sd">    Excel&#39;s calculation settings dialogue.</span>

<span class="sd">    Record SAVERECALC, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Do not recalculate;</span>
<span class="sd">                    1 = Recalculate before saving the document</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x05F</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recalc</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">recalc</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PrintHeadersRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.PrintHeadersRecord">[docs]</a><span class="k">class</span> <span class="nc">PrintHeadersRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record stores if the row and column headers</span>
<span class="sd">    (the areas with row numbers and column letters) will be printed.</span>

<span class="sd">    Record PRINTHEADERS, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Do not print row/column headers;</span>
<span class="sd">                    1 = Print row/column headers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x02A</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_headers</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">print_headers</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="PrintGridLinesRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.PrintGridLinesRecord">[docs]</a><span class="k">class</span> <span class="nc">PrintGridLinesRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record stores if sheet grid lines will be printed.</span>

<span class="sd">    Record PRINTGRIDLINES, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Do not print sheet grid lines;</span>
<span class="sd">                    1 = Print sheet grid lines</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x02B</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_grid</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">print_grid</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="GridSetRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.GridSetRecord">[docs]</a><span class="k">class</span> <span class="nc">GridSetRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record specifies if the option to print sheet grid lines</span>
<span class="sd">    (record PRINTGRIDLINES) has ever been changed.</span>

<span class="sd">    Record GRIDSET, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Print grid lines option never changed</span>
<span class="sd">                    1 = Print grid lines option changed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x082</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_grid_changed</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">print_grid_changed</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DefaultRowHeight"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.DefaultRowHeight">[docs]</a><span class="k">class</span> <span class="nc">DefaultRowHeight</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record specifies the default height and default flags</span>
<span class="sd">    for rows that do not have a corresponding ROW record.</span>

<span class="sd">    Record DEFAULTROWHEIGHT, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Option flags:</span>
<span class="sd">                    Bit Mask    Contents</span>
<span class="sd">                    0   0001H   1 = Row height and default font height do not match</span>
<span class="sd">                    1   0002H   1 = Row is hidden</span>
<span class="sd">                    2   0004H   1 = Additional space above the row</span>
<span class="sd">                    3   0008H   1 = Additional space below the row</span>
<span class="sd">    2       2       Default height for unused rows, in twips = 1/20 of a point</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0225</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">def_height</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;2H&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">def_height</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DefColWidthRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.DefColWidthRecord">[docs]</a><span class="k">class</span> <span class="nc">DefColWidthRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record specifies the default column width for columns that</span>
<span class="sd">    do not have a specific width set using the record COLINFO or COLWIDTH.</span>
<span class="sd">    This record has no effect, if a STANDARDWIDTH record is present in the file.</span>

<span class="sd">    Record DEFCOLWIDTH, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       Column width in characters, using the width of the zero</span>
<span class="sd">                    character from default font (first FONT record in the file)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0055</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">def_width</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">def_width</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HorizontalPageBreaksRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.HorizontalPageBreaksRecord">[docs]</a><span class="k">class</span> <span class="nc">HorizontalPageBreaksRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part  of  the  Page  Settings  Block. It contains all</span>
<span class="sd">    horizontal manual page breaks.</span>

<span class="sd">    Record HORIZONTALPAGEBREAKS, BIFF8:</span>
<span class="sd">    Offset  Size  Contents</span>
<span class="sd">    0       2     Number of following row index structures (nm)</span>
<span class="sd">    2       6nm   List of nm row index structures. Each row index</span>
<span class="sd">                  structure contains:</span>
<span class="sd">                    Offset  Size    Contents</span>
<span class="sd">                    0       2       Index to first row below the page break</span>
<span class="sd">                    2       2       Index to first column of this page break</span>
<span class="sd">                    4       2       Index to last column of this page break</span>

<span class="sd">    The row indexes in the lists must be ordered ascending.</span>
<span class="sd">    If in BIFF8 a row contains several page breaks, they must be ordered</span>
<span class="sd">    ascending by start column index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x001B</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">breaks_list</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">breaks_list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">breaks_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3H&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="VerticalPageBreaksRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.VerticalPageBreaksRecord">[docs]</a><span class="k">class</span> <span class="nc">VerticalPageBreaksRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part  of  the  Page  Settings  Block. It contains all</span>
<span class="sd">    vertical manual page breaks.</span>

<span class="sd">    Record VERTICALPAGEBREAKS, BIFF8:</span>
<span class="sd">    Offset  Size  Contents</span>
<span class="sd">    0       2     Number of following column index structures (nm)</span>
<span class="sd">    2       6nm   List of nm column index structures. Each column index</span>
<span class="sd">                  structure contains:</span>
<span class="sd">                    Offset  Size    Contents</span>
<span class="sd">                    0       2       Index to first column following the page</span>
<span class="sd">                                    break</span>
<span class="sd">                    2       2       Index to first row of this page break</span>
<span class="sd">                    4       2       Index to last row of this page break</span>

<span class="sd">    The column indexes in the lists must be ordered ascending.</span>
<span class="sd">    If in BIFF8 a column contains several page breaks, they must be ordered</span>
<span class="sd">    ascending by start row index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x001A</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">breaks_list</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">breaks_list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">breaks_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;3H&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HeaderRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.HeaderRecord">[docs]</a><span class="k">class</span> <span class="nc">HeaderRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of the Page Settings Block. It specifies the</span>
<span class="sd">    page  header  string  for  the current worksheet. If this record is not</span>
<span class="sd">    present  or  completely  empty  (record  size is 0), the sheet does not</span>
<span class="sd">    contain a page header.</span>

<span class="sd">    Record HEADER for non-empty page header, BIFF2-BIFF8:</span>
<span class="sd">    Offset      Size    Contents</span>
<span class="sd">    0           var.    Page header string</span>
<span class="sd">                        BIFF2-BIFF7:    Non-empty byte string, 8bit string</span>
<span class="sd">                        length</span>
<span class="sd">                        BIFF8: Non-empty Unicode string, 16bit string length</span>
<span class="sd">    The  header  string may contain special commands, i.e. placeholders for</span>
<span class="sd">    the  page  number,  current  date, or text formatting attributes. These</span>
<span class="sd">    fields  are  represented  by  single  letters (exception: font name and</span>
<span class="sd">    size,  see  below)  with  a  leading  ampersand (&quot;&amp;&quot;). If the ampersand</span>
<span class="sd">    is  part  of the regular header text, it will be duplicated (&quot;&amp;&amp;&quot;). The</span>
<span class="sd">    page  header is divided into 3 sections: the left, the centred, and the</span>
<span class="sd">    right  section.  Each  section  is introduced by a special command. All</span>
<span class="sd">    text  and all commands following are part of the selected section. Each</span>
<span class="sd">    section  starts  with the text formatting specified in the default font</span>
<span class="sd">    (first  FONT  record  in  the  file). Active formatting attributes from</span>
<span class="sd">    a previous section do not go into the next section.</span>

<span class="sd">    The following table shows all available commands:</span>

<span class="sd">    Command         Contents</span>
<span class="sd">    &amp;&amp;              The &quot;&amp;&quot; character itself</span>
<span class="sd">    &amp;L              Start of the left section</span>
<span class="sd">    &amp;C              Start of the centred section</span>
<span class="sd">    &amp;R              Start of the right section</span>
<span class="sd">    &amp;P              Current page number</span>
<span class="sd">    &amp;N              Page count</span>
<span class="sd">    &amp;D              Current date</span>
<span class="sd">    &amp;T              Current time</span>
<span class="sd">    &amp;A              Sheet name (BIFF5-BIFF8)</span>
<span class="sd">    &amp;F              File name without path</span>
<span class="sd">    &amp;Z              File path without file name (BIFF8X)</span>
<span class="sd">    &amp;G              Picture (BIFF8X)</span>
<span class="sd">    &amp;B              Bold on/off (BIFF2-BIFF4)</span>
<span class="sd">    &amp;I              Italic on/off (BIFF2-BIFF4)</span>
<span class="sd">    &amp;U              Underlining on/off</span>
<span class="sd">    &amp;E              Double underlining on/off (BIFF5-BIFF8)</span>
<span class="sd">    &amp;S              Strikeout on/off</span>
<span class="sd">    &amp;X              Superscript on/off (BIFF5-BIFF8)</span>
<span class="sd">    &amp;Y              Subscript on/off (BIFF5-BIFF8)</span>
<span class="sd">    &amp;&quot;&lt;fontname&gt;&quot;   Set new font &lt;fontname&gt;</span>
<span class="sd">    &amp;&quot;&lt;fontname&gt;,&lt;fontstyle&gt;&quot;</span>
<span class="sd">                    Set new font with specified style &lt;fontstyle&gt;.</span>
<span class="sd">                    The style &lt;fontstyle&gt; is in most cases one of</span>
<span class="sd">                    &quot;Regular&quot;, &quot;Bold&quot;, &quot;Italic&quot;, or &quot;Bold Italic&quot;.</span>
<span class="sd">                    But this setting is dependent on the used font,</span>
<span class="sd">                    it may differ (localised style names, or &quot;Standard&quot;,</span>
<span class="sd">                    &quot;Oblique&quot;, ...). (BIFF5-BIFF8)</span>
<span class="sd">    &amp;&lt;fontheight&gt;   Set font height in points (&lt;fontheight&gt; is a decimal value).</span>
<span class="sd">                    If this command is followed by a plain number to be printed</span>
<span class="sd">                    in the header, it will be separated from the font height</span>
<span class="sd">                    with a space character.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0014</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header_str</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">upack2</span><span class="p">(</span><span class="n">header_str</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FooterRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.FooterRecord">[docs]</a><span class="k">class</span> <span class="nc">FooterRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Semantic is equal to HEADER record</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0015</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">footer_str</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">upack2</span><span class="p">(</span><span class="n">footer_str</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="HCenterRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.HCenterRecord">[docs]</a><span class="k">class</span> <span class="nc">HCenterRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part  of the Page Settings Block. It specifies if the</span>
<span class="sd">    sheet is centred horizontally when printed.</span>

<span class="sd">    Record HCENTER, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Print sheet left aligned</span>
<span class="sd">                    1 = Print sheet centred horizontally</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0083</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_horz_center</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">is_horz_center</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="VCenterRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.VCenterRecord">[docs]</a><span class="k">class</span> <span class="nc">VCenterRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part  of the Page Settings Block. It specifies if the</span>
<span class="sd">    sheet is centred vertically when printed.</span>

<span class="sd">    Record VCENTER, BIFF3-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       2       0 = Print sheet aligned at top page border</span>
<span class="sd">                    1 = Print sheet vertically centred</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0084</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_vert_center</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">is_vert_center</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="LeftMarginRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.LeftMarginRecord">[docs]</a><span class="k">class</span> <span class="nc">LeftMarginRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part of the Page Settings Block. It contains the left</span>
<span class="sd">    page margin of the current worksheet.</span>

<span class="sd">    Record LEFTMARGIN, BIFF2-BIFF8:</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       8       Left page margin in inches</span>
<span class="sd">                    (IEEE 754 floating-point value, 64bit double precision)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0026</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;d&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="RightMarginRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.RightMarginRecord">[docs]</a><span class="k">class</span> <span class="nc">RightMarginRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part of the Page Settings Block. It contains the right</span>
<span class="sd">    page margin of the current worksheet.</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       8       Right page margin in inches</span>
<span class="sd">                    (IEEE 754 floating-point value, 64?bit double precision)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0027</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;d&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TopMarginRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.TopMarginRecord">[docs]</a><span class="k">class</span> <span class="nc">TopMarginRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part of the Page Settings Block. It contains the top</span>
<span class="sd">    page margin of the current worksheet.</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       8       Top page margin in inches</span>
<span class="sd">                    (IEEE 754 floating-point value, 64?bit double precision)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0028</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;d&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="BottomMarginRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.BottomMarginRecord">[docs]</a><span class="k">class</span> <span class="nc">BottomMarginRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This  record  is  part of the Page Settings Block. It contains the bottom</span>
<span class="sd">    page margin of the current worksheet.</span>

<span class="sd">    Offset  Size    Contents</span>
<span class="sd">    0       8       Bottom page margin in inches</span>
<span class="sd">                    (IEEE 754 floating-point value, 64?bit double precision)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0029</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;d&#39;</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SetupPageRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SetupPageRecord">[docs]</a><span class="k">class</span> <span class="nc">SetupPageRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This   record   is  part of the Page Settings Block. It stores the page</span>
<span class="sd">    format   settings   of   the  current sheet. The pages may be scaled in</span>
<span class="sd">    percent   or  by  using  an  absolute  number of pages. This setting is</span>
<span class="sd">    located   in  the  WSBOOL  record.  If  pages  are  scaled in  percent,</span>
<span class="sd">    the   scaling  factor  in  this  record is used, otherwise the &quot;Fit  to</span>
<span class="sd">    pages&quot;  values. One of the &quot;Fit to pages&quot; values may be 0. In this case</span>
<span class="sd">    the sheet is scaled to fit only to the other value.</span>

<span class="sd">    Record SETUP, BIFF5-BIFF8:</span>

<span class="sd">    Offset      Size    Contents</span>
<span class="sd">    0           2       Paper size (see below)</span>
<span class="sd">    2           2       Scaling factor in percent</span>
<span class="sd">    4           2       Start page number</span>
<span class="sd">    6           2       Fit worksheet width to this number of pages</span>
<span class="sd">                        (0 = use as many as needed)</span>
<span class="sd">    8           2       Fit worksheet height to this number of pages</span>
<span class="sd">                        (0 = use as many as needed)</span>
<span class="sd">    10          2       Option flags:</span>
<span class="sd">                        Bit     Mask        Contents</span>
<span class="sd">                        0       0001H       0 = Print pages in columns</span>
<span class="sd">                                            1 = Print pages in rows</span>
<span class="sd">                        1       0002H       0 = Landscape</span>
<span class="sd">                                            1 = Portrait</span>
<span class="sd">                        2       0004H       1 = Paper size, scaling factor,</span>
<span class="sd">                                            paper orientation (portrait/landscape),</span>
<span class="sd">                                            print resolution and number of copies</span>
<span class="sd">                                            are not initialised</span>
<span class="sd">                        3       0008H       0 = Print coloured</span>
<span class="sd">                                            1 = Print black and white</span>
<span class="sd">                        4       0010H       0 = Default print quality</span>
<span class="sd">                                            1 = Draft quality</span>
<span class="sd">                        5       0020H       0 = Do not print cell notes</span>
<span class="sd">                                            1 = Print cell notes</span>
<span class="sd">                        6       0040H       0 = Paper orientation setting is valid</span>
<span class="sd">                                            1 = Paper orientation setting not</span>
<span class="sd">                                            initialised</span>
<span class="sd">                        7       0080H       0 = Automatic page numbers</span>
<span class="sd">                                            1 = Use start page number</span>
<span class="sd">                        The following flags are valid for BIFF8 only:</span>
<span class="sd">                        9       0200H       0 = Print notes as displayed</span>
<span class="sd">                                            1 = Print notes at end of sheet</span>
<span class="sd">                        11-10   0C00H       00 = Print errors as displayed</span>
<span class="sd">                                            01 = Do not print errors</span>
<span class="sd">                                            10 = Print errors as &quot;--&quot;</span>
<span class="sd">                                            11 = Print errors as &quot;#N/A!&quot;</span>
<span class="sd">    12          2       Print resolution in dpi</span>
<span class="sd">    14          2       Vertical print resolution in dpi</span>
<span class="sd">    16          8       Header margin (IEEE 754 floating-point value,</span>
<span class="sd">                        64bit double precision)</span>
<span class="sd">    24          8       Footer margin (IEEE 754 floating-point value,</span>
<span class="sd">                        64bit double precision)</span>
<span class="sd">    32          2       Number of copies to print</span>


<span class="sd">    PAPER TYPES:</span>

<span class="sd">    Index   Paper type              Paper size</span>
<span class="sd">    0       Undefined</span>
<span class="sd">    1       Letter                  8 1/2&quot; x 11&quot;</span>
<span class="sd">    2       Letter small            8 1/2&quot; x 11&quot;</span>
<span class="sd">    3       Tabloid                 11&quot; x 17&quot;</span>
<span class="sd">    4       Ledger                  17&quot; x 11&quot;</span>
<span class="sd">    5       Legal                   8 1/2&quot; x 14&quot;</span>
<span class="sd">    6       Statement               5 1/2&quot; x 8 1/2&quot;</span>
<span class="sd">    7       Executive               7 1/4&quot; x 10 1/2&quot;</span>
<span class="sd">    8       A3                      297mm x 420mm</span>
<span class="sd">    9       A4                      210mm x 297mm</span>
<span class="sd">    10      A4 small                210mm x 297mm</span>
<span class="sd">    11      A5                      148mm x 210mm</span>
<span class="sd">    12      B4 (JIS)                257mm x 364mm</span>
<span class="sd">    13      B5 (JIS)                182mm x 257mm</span>
<span class="sd">    14      Folio                   8 1/2&quot; x 13&quot;</span>
<span class="sd">    15      Quarto                  215mm x 275mm</span>
<span class="sd">    16      10x14                   10&quot; x 14&quot;</span>
<span class="sd">    17      11x17                   11&quot; x 17&quot;</span>
<span class="sd">    18      Note                    8 1/2&quot; x 11&quot;</span>
<span class="sd">    19      Envelope #9             3 7/8&quot; x 8 7/8&quot;</span>
<span class="sd">    20      Envelope #10            4 1/8&quot; x 9 1/2&quot;</span>
<span class="sd">    21      Envelope #11            4 1/2&quot; x 10 3/8&quot;</span>
<span class="sd">    22      Envelope #12            4 3/4&quot; x 11&quot;</span>
<span class="sd">    23      Envelope #14            5&quot; x 11 1/2&quot;</span>
<span class="sd">    24      C                       17&quot; x 22&quot;</span>
<span class="sd">    25      D                       22&quot; x 34&quot;</span>
<span class="sd">    26      E                       34&quot; x 44&quot;</span>
<span class="sd">    27      Envelope DL             110mm x 220mm</span>
<span class="sd">    28      Envelope C5             162mm x 229mm</span>
<span class="sd">    29      Envelope C3             324mm x 458mm</span>
<span class="sd">    30      Envelope C4             229mm x 324mm</span>
<span class="sd">    31      Envelope C6             114mm x 162mm</span>
<span class="sd">    32      Envelope C6/C5          114mm x 229mm</span>
<span class="sd">    33      B4 (ISO)                250mm x 353mm</span>
<span class="sd">    34      B5 (ISO)                176mm x 250mm</span>
<span class="sd">    35      B6 (ISO)                125mm x 176mm</span>
<span class="sd">    36      Envelope Italy          110mm x 230mm</span>
<span class="sd">    37      Envelope Monarch        3 7/8&quot; x 7 1/2&quot;</span>
<span class="sd">    38      63/4 Envelope           3 5/8&quot; x 6 1/2&quot;</span>
<span class="sd">    39      US Standard Fanfold     14 7/8&quot; x 11&quot;</span>
<span class="sd">    40      German Std. Fanfold     8 1/2&quot; x 12&quot;</span>
<span class="sd">    41      German Legal Fanfold    8 1/2&quot; x 13&quot;</span>
<span class="sd">    42      B4 (ISO)                250mm x 353mm</span>
<span class="sd">    43      Japanese Postcard       100mm x 148mm</span>
<span class="sd">    44      9x11                    9&quot; x 11&quot;</span>
<span class="sd">    45      10x11                   10&quot; x 11&quot;</span>
<span class="sd">    46      15x11                   15&quot; x 11&quot;</span>
<span class="sd">    47      Envelope Invite         220mm x 220mm</span>
<span class="sd">    48      Undefined</span>
<span class="sd">    49      Undefined</span>
<span class="sd">    50      Letter Extra            9 1/2&quot; x 12&quot;</span>
<span class="sd">    51      Legal Extra             9 1/2&quot; x 15&quot;</span>
<span class="sd">    52      Tabloid Extra           11 11/16&quot; x 18&quot;</span>
<span class="sd">    53      A4 Extra                235mm x 322mm</span>
<span class="sd">    54      Letter Transverse       8 1/2&quot; x 11&quot;</span>
<span class="sd">    55      A4 Transverse           210mm x 297mm</span>
<span class="sd">    56      Letter Extra Transv.    9 1/2&quot; x 12&quot;</span>
<span class="sd">    57      Super A/A4              227mm x 356mm</span>
<span class="sd">    58      Super B/A3              305mm x 487mm</span>
<span class="sd">    59      Letter Plus             8 1/2&quot; x 12 11/16&quot;</span>
<span class="sd">    60      A4 Plus                 210mm x 330mm</span>
<span class="sd">    61      A5 Transverse           148mm x 210mm</span>
<span class="sd">    62      B5 (JIS) Transverse     182mm x 257mm</span>
<span class="sd">    63      A3 Extra                322mm x 445mm</span>
<span class="sd">    64      A5 Extra                174mm x 235mm</span>
<span class="sd">    65      B5 (ISO) Extra          201mm x 276mm</span>
<span class="sd">    66      A2                      420mm x 594mm</span>
<span class="sd">    67      A3 Transverse           297mm x 420mm</span>
<span class="sd">    68      A3 Extra Transverse     322mm x 445mm</span>
<span class="sd">    69      Dbl. Japanese Postcard  200mm x 148mm</span>
<span class="sd">    70      A6                      105mm x 148mm</span>
<span class="sd">    71</span>
<span class="sd">    72</span>
<span class="sd">    73</span>
<span class="sd">    74</span>
<span class="sd">    75      Letter Rotated          11&quot; x 8 1/2&quot;</span>
<span class="sd">    76      A3 Rotated              420mm x 297mm</span>
<span class="sd">    77      A4 Rotated              297mm x 210mm</span>
<span class="sd">    78      A5 Rotated              210mm x 148mm</span>
<span class="sd">    79      B4 (JIS) Rotated        364mm x 257mm</span>
<span class="sd">    80      B5 (JIS) Rotated        257mm x 182mm</span>
<span class="sd">    81      Japanese Postcard Rot.  148mm x 100mm</span>
<span class="sd">    82      Dbl. Jap. Postcard Rot. 148mm x 200mm</span>
<span class="sd">    83      A6 Rotated              148mm x 105mm</span>
<span class="sd">    84</span>
<span class="sd">    85</span>
<span class="sd">    86</span>
<span class="sd">    87</span>
<span class="sd">    88      B6 (JIS)                128mm x 182mm</span>
<span class="sd">    89      B6 (JIS) Rotated        182mm x 128mm</span>
<span class="sd">    90      12x11                   12&quot; x 11&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x00A1</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paper</span><span class="p">,</span> <span class="n">scaling</span><span class="p">,</span> <span class="n">start_num</span><span class="p">,</span> <span class="n">fit_width_to</span><span class="p">,</span> <span class="n">fit_height_to</span><span class="p">,</span>
                    <span class="n">options</span><span class="p">,</span>
                    <span class="n">hres</span><span class="p">,</span> <span class="n">vres</span><span class="p">,</span>
                    <span class="n">header_margin</span><span class="p">,</span> <span class="n">footer_margin</span><span class="p">,</span>
                    <span class="n">num_copies</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;8H2dH&#39;</span><span class="p">,</span> <span class="n">paper</span><span class="p">,</span> <span class="n">scaling</span><span class="p">,</span> <span class="n">start_num</span><span class="p">,</span>
                                        <span class="n">fit_width_to</span><span class="p">,</span> <span class="n">fit_height_to</span><span class="p">,</span> \
                                        <span class="n">options</span><span class="p">,</span>
                                        <span class="n">hres</span><span class="p">,</span> <span class="n">vres</span><span class="p">,</span>
                                        <span class="n">header_margin</span><span class="p">,</span> <span class="n">footer_margin</span><span class="p">,</span>
                                        <span class="n">num_copies</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="NameRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.NameRecord">[docs]</a><span class="k">class</span> <span class="nc">NameRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record is part of a Link Table. It contains the name and the token</span>
<span class="sd">    array of an internal defined name. Token arrays of defined names</span>
<span class="sd">    contain tokens with aberrant token classes.</span>

<span class="sd">    Record NAME, BIFF5/BIFF7:</span>
<span class="sd">    Offset      Size    Contents</span>
<span class="sd">       0          2     Option flags, see below</span>
<span class="sd">       2          1     Keyboard shortcut (only for command macro names, see below)</span>
<span class="sd">       3          1     Length of the name (character count, ln)</span>
<span class="sd">       4          2     Size of the formula data (sz)</span>
<span class="sd">       6          2     0 = Global name, otherwise index to EXTERNSHEET record (one-based)</span>
<span class="sd">       8          2     0 = Global name, otherwise index to sheet (one-based)</span>
<span class="sd">      10          1     Length of menu text (character count, lm)</span>
<span class="sd">      11          1     Length of description text (character count, ld)</span>
<span class="sd">      12          1     Length of help topic text (character count, lh)</span>
<span class="sd">      13          1     Length of status bar text (character count, ls)</span>
<span class="sd">      14         ln     Character array of the name</span>
<span class="sd">    14+ln        sz     Formula data (RPN token array without size field, 4)</span>
<span class="sd">  14+ln+sz       lm     Character array of menu text</span>
<span class="sd">     var.        ld     Character array of description text</span>
<span class="sd">     var.        lh     Character array of help topic text</span>
<span class="sd">     var.        ls     Character array of status bar text</span>

<span class="sd">    Record NAME, BIFF8:</span>
<span class="sd">    Offset      Size Contents</span>
<span class="sd">       0          2  Option flags, see below</span>
<span class="sd">       2          1  Keyboard shortcut (only for command macro names, see below)</span>
<span class="sd">       3          1  Length of the name (character count, ln)</span>
<span class="sd">       4          2  Size of the formula data (sz)</span>
<span class="sd">       6          2  Not used</span>
<span class="sd">       8          2  0 = Global name, otherwise index to sheet (one-based)</span>
<span class="sd">      10          1  Length of menu text (character count, lm)</span>
<span class="sd">      11          1  Length of description text (character count, ld)</span>
<span class="sd">      12          1  Length of help topic text (character count, lh)</span>
<span class="sd">      13          1  Length of status bar text (character count, ls)</span>
<span class="sd">      14        var. Name (Unicode string without length field, 3.4)</span>
<span class="sd">     var.        sz  Formula data (RPN token array without size field, 4)</span>
<span class="sd">    [var.]      var. (optional, only if lm &gt; 0) Menu text (Unicode string without length field, 3.4)</span>
<span class="sd">    [var.]      var. (optional, only if ld &gt; 0) Description text (Unicode string without length field, 3.4)</span>
<span class="sd">    [var.]      var. (optional, only if lh &gt; 0) Help topic text (Unicode string without length field, 3.4)</span>
<span class="sd">    [var.]      var. (optional, only if ls &gt; 0) Status bar text (Unicode string without length field, 3.4)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0018</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">keyboard_shortcut</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sheet_index</span><span class="p">,</span> <span class="n">rpn</span><span class="p">,</span> <span class="n">menu_text</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">desc_text</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">status_text</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">uname</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">uname</span> <span class="o">=</span> <span class="n">upack1</span><span class="p">(</span><span class="n">name</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">uname_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">uname</span><span class="p">)</span>
        
        <span class="c">#~ self._rec_data = struct.pack(&#39;&lt;HBBHHHBBBB%ds%ds&#39; % (uname_len, len(rpn)), options, keyboard_shortcut, uname_len, len(rpn), 0x0000, sheet_index, len(menu_text), len(desc_text), len(help_text), len(status_text), uname, rpn) + menu_text + desc_text + help_text + status_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;HBBHHHBBBBB</span><span class="si">%d</span><span class="s">s</span><span class="si">%d</span><span class="s">s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uname_len</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpn</span><span class="p">)),</span> <span class="n">options</span><span class="p">,</span> <span class="n">keyboard_shortcut</span><span class="p">,</span> <span class="n">uname_len</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rpn</span><span class="p">),</span> <span class="mh">0x0000</span><span class="p">,</span> <span class="n">sheet_index</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">menu_text</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">desc_text</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">help_text</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">status_text</span><span class="p">),</span> <span class="n">uname</span><span class="p">,</span> <span class="n">rpn</span><span class="p">)</span> <span class="o">+</span> <span class="n">menu_text</span> <span class="o">+</span> <span class="n">desc_text</span> <span class="o">+</span> <span class="n">help_text</span> <span class="o">+</span> <span class="n">status_text</span>
        
        <span class="c">#~ print repr(self.get())</span>
        <span class="c">#~ print repr(self._rec_data)</span>
        <span class="c">#~ print len(self._rec_data)</span>
</div>
<div class="viewcode-block" id="ExternSheetRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.ExternSheetRecord">[docs]</a><span class="k">class</span> <span class="nc">ExternSheetRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    In BIFF8 the record stores a list with indexes to SUPBOOK</span>
<span class="sd">    records (list of REF structures, 6.100). See 5.10.3 for </span>
<span class="sd">    details about external references in BIFF8.</span>
<span class="sd">    </span>
<span class="sd">    Record EXTERNSHEET, BIFF8:</span>
<span class="sd">    Offset          Size      Contents</span>
<span class="sd">       0             2        Number of following REF structures (nm)</span>
<span class="sd">       2           6nm        List of nm REF structures. Each REF contains the following data:</span>
<span class="sd">                              Offset     Size     Contents</span>
<span class="sd">                                 0         2      Index to SUPBOOK record</span>
<span class="sd">                                 2         2      Index to first SUPBOOK sheet</span>
<span class="sd">                                 4         2      Index to last SUPBOOK sheet</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x0017</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refs</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="c"># do we always need this ref? or only if there are no refs?</span>
        <span class="n">refs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="c">#~ ref_data = &#39;&#39;.join([ref.get() for r in refs])</span>
        <span class="n">ref_data</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;HHH&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">refs</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;H</span><span class="si">%d</span><span class="s">s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">refs</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">refs</span><span class="p">),</span> <span class="n">ref_data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SupBookRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.SupBookRecord">[docs]</a><span class="k">class</span> <span class="nc">SupBookRecord</span><span class="p">(</span><span class="n">BiffRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This record mainly stores the URL of an external document</span>
<span class="sd">    and a list of sheet names inside this document. Furthermore</span>
<span class="sd">    it is used to store DDE and OLE object links, or to indicate</span>
<span class="sd">    an internal 3D reference or an add-in function. See 5.10.3</span>
<span class="sd">    for details about external references in BIFF8.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_REC_ID</span> <span class="o">=</span> <span class="mh">0x01AE</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiffRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="InternalReferenceSupBookRecord"><a class="viewcode-back" href="../../pyExcelerator.html#pyExcelerator.BIFFRecords.InternalReferenceSupBookRecord">[docs]</a><span class="k">class</span> <span class="nc">InternalReferenceSupBookRecord</span><span class="p">(</span><span class="n">SupBookRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    In each file occurs a SUPBOOK that is used for internal 3D</span>
<span class="sd">    references. It stores the number of sheets of the own document.</span>
<span class="sd">    </span>
<span class="sd">    Record SUPBOOK for 3D references, BIFF8:</span>
<span class="sd">    Offset         Size   Contents</span>
<span class="sd">      0             2     Number of sheets in this document</span>
<span class="sd">      2             2     01H 04H (relict of BIFF5/BIFF7, the byte string &quot;&lt;04H&gt;&quot;, see 3.9.1)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_sheets</span><span class="p">):</span>
        <span class="n">SupBookRecord</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_rec_data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s">&#39;&lt;HBB&#39;</span><span class="p">,</span> <span class="n">num_sheets</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <script type="text/javascript">
    /* <![CDATA[ */
        (function() {
            var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
            s.type = 'text/javascript';
            s.async = true;
            s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
            t.parentNode.insertBefore(s, t);
        })();
    /* ]]> */</script>

    <div class="footer">
      &copy; Copyright 2012, Rick van Hattem.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
    </div>
  </body>
</html>